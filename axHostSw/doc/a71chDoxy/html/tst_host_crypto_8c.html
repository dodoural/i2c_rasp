<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>A71CH Host Sw: C:/ubuntu_exchange/axHostSw/hostLib/tstUtil/tstHostCrypto.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">A71CH Host Sw
   &#160;<span id="projectnumber">v01.05.00</span>
   </div>
   <div id="projectbrief">NXP Semiconductors</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('tst_host_crypto_8c.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">tstHostCrypto.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;assert.h&gt;</code><br />
<code>#include &quot;<a class="el" href="ax__util_8h_source.html">ax_util.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="sm__types_8h_source.html">sm_types.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="sm__apdu_8h_source.html">sm_apdu.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="tst__sm__util_8h_source.html">tst_sm_util.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="ax_host_crypto_8h_source.html">axHostCrypto.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="tst_host_crypto_8h_source.html">tstHostCrypto.h</a>&quot;</code><br />
<code>#include &lt;openssl/obj_mac.h&gt;</code><br />
<code>#include &lt;openssl/ecdsa.h&gt;</code><br />
<code>#include &lt;openssl/ecdh.h&gt;</code><br />
<code>#include &lt;openssl/sha.h&gt;</code><br />
<code>#include &lt;openssl/rsa.h&gt;</code><br />
<code>#include &lt;openssl/ec.h&gt;</code><br />
<code>#include &lt;openssl/evp.h&gt;</code><br />
<code>#include &lt;openssl/err.h&gt;</code><br />
<code>#include &lt;openssl/hmac.h&gt;</code><br />
</div>
<p><a href="tst_host_crypto_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a7c5524f468f6a87ee91b8bb4c7fea2a4"><td class="memItemLeft" align="right" valign="top"><a id="a7c5524f468f6a87ee91b8bb4c7fea2a4"></a>
unsigned char *&#160;</td><td class="memItemRight" valign="bottom"><b>HKDF</b> (const EVP_MD *evp_md, const unsigned char *salt, size_t salt_len, const unsigned char *key, size_t key_len, const unsigned char *info, size_t info_len, unsigned char *okm, size_t okm_len)</td></tr>
<tr class="separator:a7c5524f468f6a87ee91b8bb4c7fea2a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93ebc98dc160ba1f6bfdcdeee9909517"><td class="memItemLeft" align="right" valign="top"><a id="a93ebc98dc160ba1f6bfdcdeee9909517"></a>
unsigned char *&#160;</td><td class="memItemRight" valign="bottom"><b>HKDF_Expand</b> (const EVP_MD *evp_md, const unsigned char *prk, size_t prk_len, const unsigned char *info, size_t info_len, unsigned char *okm, size_t okm_len)</td></tr>
<tr class="separator:a93ebc98dc160ba1f6bfdcdeee9909517"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94a637d41b0673dbee616ee0a0deeb08"><td class="memItemLeft" align="right" valign="top"><a id="a94a637d41b0673dbee616ee0a0deeb08"></a>
static int&#160;</td><td class="memItemRight" valign="bottom"><b>axECCCurveType_2_OpenSSL</b> (<a class="el" href="sm__types_8h.html#a2281a38532f01707192bc9a4b1d81c47">ECCCurve_t</a> eccCurve)</td></tr>
<tr class="separator:a94a637d41b0673dbee616ee0a0deeb08"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f6b98d7b51b83e31da04150211209de"><td class="memItemLeft" align="right" valign="top"><a id="a9f6b98d7b51b83e31da04150211209de"></a>
U16&#160;</td><td class="memItemRight" valign="bottom"><b>HOSTCRYPTO_Sign</b> (EC_KEY *pKey, U8 *pInputData, U16 inputLength, U8 *pSignature, U16 *pSignatureLength, U8 signatureFormat)</td></tr>
<tr class="separator:a9f6b98d7b51b83e31da04150211209de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25ee7473d788d1fb8cf945482e600f59"><td class="memItemLeft" align="right" valign="top"><a id="a25ee7473d788d1fb8cf945482e600f59"></a>
U16&#160;</td><td class="memItemRight" valign="bottom"><b>HOSTCRYPTO_ECC_ComputeSharedSecret</b> (EC_KEY *pKey, U8 *pubKey, U16 pubKeyLen, U8 *pSharedSecretData, U16 *pSharedSecretDataLen)</td></tr>
<tr class="separator:a25ee7473d788d1fb8cf945482e600f59"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca5363e321d6cdc668895445e0f40742"><td class="memItemLeft" align="right" valign="top">U16&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tst_host_crypto_8c.html#aca5363e321d6cdc668895445e0f40742">HOSTCRYPTO_GetPublicKey</a> (EC_KEY *pKey, U8 *pPublicKeyData, U16 *pPublicKeyLen, U16 maxPublicKeyLen)</td></tr>
<tr class="separator:aca5363e321d6cdc668895445e0f40742"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84eb3228f8d2c760d3816d171271114b"><td class="memItemLeft" align="right" valign="top">U16&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tst_host_crypto_8c.html#a84eb3228f8d2c760d3816d171271114b">HOSTCRYPTO_GetPrivateKey</a> (EC_KEY *pKey, U8 *pPrivateKeyData, U16 *pPrivateKeyLen, U16 maxPrivateKeyLen)</td></tr>
<tr class="separator:a84eb3228f8d2c760d3816d171271114b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e5f971e8847c9520149e2da2c2dd5e1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tst_host_crypto_8c.html#a0e5f971e8847c9520149e2da2c2dd5e1">HOSTCRYPTO_FreeEccKey</a> (EC_KEY **ppKey)</td></tr>
<tr class="separator:a0e5f971e8847c9520149e2da2c2dd5e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a919b22acaf4c3355330a895d349449e0"><td class="memItemLeft" align="right" valign="top">U16&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tst_host_crypto_8c.html#a919b22acaf4c3355330a895d349449e0">HOSTCRYPTO_GenerateEccKey</a> (<a class="el" href="sm__types_8h.html#a2281a38532f01707192bc9a4b1d81c47">ECCCurve_t</a> curveType, EC_KEY **ppKey)</td></tr>
<tr class="separator:a919b22acaf4c3355330a895d349449e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1b282afff9eec3fbd291ca7eef1f9e0"><td class="memItemLeft" align="right" valign="top">U16&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tst_host_crypto_8c.html#ae1b282afff9eec3fbd291ca7eef1f9e0">HOSTCRYPTO_EccCreateOpenSslEccFromComponents</a> (EC_KEY **eccRef, <a class="el" href="structecc_key_components__t.html">eccKeyComponents_t</a> *eccKc)</td></tr>
<tr class="separator:ae1b282afff9eec3fbd291ca7eef1f9e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff9d12d454ff58ea0eba20427f71035c"><td class="memItemLeft" align="right" valign="top">U16&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tst_host_crypto_8c.html#aff9d12d454ff58ea0eba20427f71035c">HOSTCRYPTO_AesUnwrapKeyRFC3394</a> (const U8 *wrapKey, U16 wrapKeyLen, U8 *out, U16 *outLen, const U8 *in, U16 inLen)</td></tr>
<tr class="separator:aff9d12d454ff58ea0eba20427f71035c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae34db768c6e12019b9fe5dc5661ef586"><td class="memItemLeft" align="right" valign="top">U16&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tst_host_crypto_8c.html#ae34db768c6e12019b9fe5dc5661ef586">HOSTCRYPTO_AesWrapKeyRFC3394</a> (const U8 *wrapKey, U16 wrapKeyLen, U8 *out, U16 *outLen, const U8 *in, U16 inLen)</td></tr>
<tr class="separator:ae34db768c6e12019b9fe5dc5661ef586"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74afa172f19f87e5df3fdb0b7eb6975c"><td class="memItemLeft" align="right" valign="top"><a id="a74afa172f19f87e5df3fdb0b7eb6975c"></a>
U16&#160;</td><td class="memItemRight" valign="bottom"><b>HOSTCRYPTO_HkdfExpandSha256</b> (const U8 *secret, U16 secretLen, const U8 *info, U16 infoLen, U8 *derivedData, U16 derivedDataLen)</td></tr>
<tr class="separator:a74afa172f19f87e5df3fdb0b7eb6975c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d62dbdfb261cba9745929cf9c2aac77"><td class="memItemLeft" align="right" valign="top"><a id="a1d62dbdfb261cba9745929cf9c2aac77"></a>
U16&#160;</td><td class="memItemRight" valign="bottom"><b>HOSTCRYPTO_HkdfFullSha256</b> (const U8 *salt, U16 saltLen, const U8 *secret, U16 secretLen, const U8 *info, U16 infoLen, U8 *derivedData, U16 derivedDataLen)</td></tr>
<tr class="separator:a1d62dbdfb261cba9745929cf9c2aac77"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01f8517e9bd87827dd7de4e29de2386b"><td class="memItemLeft" align="right" valign="top"><a id="a01f8517e9bd87827dd7de4e29de2386b"></a>
U16&#160;</td><td class="memItemRight" valign="bottom"><b>HOSTCRYPTO_TlsPskCreatePremasterSecret</b> (const U8 *secret, U16 secretLen, U8 *premasterSecret, U16 *premasterSecretLen)</td></tr>
<tr class="separator:a01f8517e9bd87827dd7de4e29de2386b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e58080714ca98647c2e9d18c30d3277"><td class="memItemLeft" align="right" valign="top"><a id="a4e58080714ca98647c2e9d18c30d3277"></a>
U16&#160;</td><td class="memItemRight" valign="bottom"><b>HOSTCRYPTO_TlsEcdhPskCreatePremasterSecret</b> (const U8 *ecdhSS, U16 ecdhSSLen, const U8 *secret, U16 secretLen, U8 *premasterSecret, U16 *premasterSecretLen)</td></tr>
<tr class="separator:a4e58080714ca98647c2e9d18c30d3277"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3206a22c8425ed148f304ff112b46b5"><td class="memItemLeft" align="right" valign="top"><a id="af3206a22c8425ed148f304ff112b46b5"></a>
U16&#160;</td><td class="memItemRight" valign="bottom"><b>HOSTCRYPTO_HmacSha256</b> (const U8 *secret, U16 secretLen, const U8 *data, U16 dataLen, U8 *hmacData)</td></tr>
<tr class="separator:af3206a22c8425ed148f304ff112b46b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab99ef0b3d5bccdbb1f9eb87f29b1d17e"><td class="memItemLeft" align="right" valign="top"><a id="ab99ef0b3d5bccdbb1f9eb87f29b1d17e"></a>
U16&#160;</td><td class="memItemRight" valign="bottom"><b>HOSTCRYPTO_Tls1_2_P_Sha256</b> (const U8 *secret, U16 secretLen, const U8 *seed, U16 seedLen, U8 *derivedData, U16 derivedDataLen)</td></tr>
<tr class="separator:ab99ef0b3d5bccdbb1f9eb87f29b1d17e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><dl class="section author"><dt>Author</dt><dd>NXP Semiconductors </dd></dl>
<dl class="section version"><dt>Version</dt><dd>1.0 </dd></dl>
<dl class="section user"><dt>License</dt><dd>Copyright 2016 NXP</dd></dl>
<p>This software is owned or controlled by NXP and may only be used strictly in accordance with the applicable license terms. By expressly accepting such terms or by downloading, installing, activating and/or otherwise using the software, you are agreeing that you have read, and that you agree to comply with and are bound by, such license terms. If you do not agree to be bound by the applicable license terms, then you may not retain, install, activate or otherwise use the software.</p>
<dl class="section user"><dt>Description</dt><dd>Module implementing host based crypto functionality used in example programs. This module relies on the availability of OpenSSL on the Host plaform. </dd></dl>
<dl class="section user"><dt>HISTORY</dt><dd></dd></dl>

<p class="definition">Definition in file <a class="el" href="tst_host_crypto_8c_source.html">tstHostCrypto.c</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="aff9d12d454ff58ea0eba20427f71035c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aff9d12d454ff58ea0eba20427f71035c">&#9670;&nbsp;</a></span>HOSTCRYPTO_AesUnwrapKeyRFC3394()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">U16 HOSTCRYPTO_AesUnwrapKeyRFC3394 </td>
          <td>(</td>
          <td class="paramtype">const U8 *&#160;</td>
          <td class="paramname"><em>wrapKey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">U16&#160;</td>
          <td class="paramname"><em>wrapKeyLen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">U8 *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">U16 *&#160;</td>
          <td class="paramname"><em>outLen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const U8 *&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">U16&#160;</td>
          <td class="paramname"><em>inLen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Key unwrapping according to RFC3394 (<a href="https://tools.ietf.org/html/rfc3394">https://tools.ietf.org/html/rfc3394</a>) </p><dl class="section note"><dt>Note</dt><dd>Only tested with an 128 bits wrapKey. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">wrapKey</td><td>Secret key used to unwrap <code>in</code> with. Also called KEK (key encryption key) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">wrapKeyLen</td><td>Length in byte of wrapKey </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">out</td><td>IN: buffer of at least <code>outLen</code> byte; OUT: unwrapped key </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">outLen</td><td>IN: size of buffer <code>out</code> provided; OUT: actual length of unwrapped key </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">in</td><td>Wrapped key to be unwrapped </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">inLen</td><td>Length in byte of key to be unwrapped </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="tst_host_crypto_8c_source.html#l00533">533</a> of file <a class="el" href="tst_host_crypto_8c_source.html">tstHostCrypto.c</a>.</p>

</div>
</div>
<a id="ae34db768c6e12019b9fe5dc5661ef586"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae34db768c6e12019b9fe5dc5661ef586">&#9670;&nbsp;</a></span>HOSTCRYPTO_AesWrapKeyRFC3394()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">U16 HOSTCRYPTO_AesWrapKeyRFC3394 </td>
          <td>(</td>
          <td class="paramtype">const U8 *&#160;</td>
          <td class="paramname"><em>wrapKey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">U16&#160;</td>
          <td class="paramname"><em>wrapKeyLen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">U8 *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">U16 *&#160;</td>
          <td class="paramname"><em>outLen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const U8 *&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">U16&#160;</td>
          <td class="paramname"><em>inLen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Key wrapping according to RFC3394 (<a href="https://tools.ietf.org/html/rfc3394">https://tools.ietf.org/html/rfc3394</a>) </p><dl class="section note"><dt>Note</dt><dd>Only tested with an 128 bits wrapKey. When wrapping a 128 bit key (16 byte), the resulting wrapped key is 24 byte long. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">wrapKey</td><td>Secret key used to wrap <code>in</code>. Also called KEK (key encryption key) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">wrapKeyLen</td><td>Length in byte of wrapKey </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">out</td><td>IN: buffer of at least <code>outLen</code> byte; OUT: wrapped key </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">outLen</td><td>IN: size of buffer <code>out</code> provided; OUT: actual length of wrapped key </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">in</td><td>Key to be wrapped </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">inLen</td><td>Length in byte of key to be wrapped </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="tst_host_crypto_8c_source.html#l00582">582</a> of file <a class="el" href="tst_host_crypto_8c_source.html">tstHostCrypto.c</a>.</p>

</div>
</div>
<a id="ae1b282afff9eec3fbd291ca7eef1f9e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae1b282afff9eec3fbd291ca7eef1f9e0">&#9670;&nbsp;</a></span>HOSTCRYPTO_EccCreateOpenSslEccFromComponents()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">U16 HOSTCRYPTO_EccCreateOpenSslEccFromComponents </td>
          <td>(</td>
          <td class="paramtype">EC_KEY **&#160;</td>
          <td class="paramname"><em>eccRef</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structecc_key_components__t.html">eccKeyComponents_t</a> *&#160;</td>
          <td class="paramname"><em>eccKc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Create an OpenSSL specific key structure and fill it up with the ECC key material contained in the crypto library agnostic <code>eccKc</code> data structure. In case <code>eccKc</code> does not contain a private key, only the public part will be copied into the OpenSSL specific key structure.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">eccRef</td><td>Double indirection to EC_KEY (OpenSSL) data structure. In case *ppKey already points to a key object, that object is freed first. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">eccKc</td><td>Data structure containing ECC key material. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="tst_host_crypto_8c_source.html#l00393">393</a> of file <a class="el" href="tst_host_crypto_8c_source.html">tstHostCrypto.c</a>.</p>

</div>
</div>
<a id="a0e5f971e8847c9520149e2da2c2dd5e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e5f971e8847c9520149e2da2c2dd5e1">&#9670;&nbsp;</a></span>HOSTCRYPTO_FreeEccKey()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void HOSTCRYPTO_FreeEccKey </td>
          <td>(</td>
          <td class="paramtype">EC_KEY **&#160;</td>
          <td class="paramname"><em>ppKey</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Free ECC key object </p><dl class="section post"><dt>Postcondition</dt><dd>pointer passed as argument is pointing to NULL </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ppKey</td><td>Reference to pointer (double indirection) to EC_KEY (OpenSSL) data structure </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="tst_host_crypto_8c_source.html#l00331">331</a> of file <a class="el" href="tst_host_crypto_8c_source.html">tstHostCrypto.c</a>.</p>

</div>
</div>
<a id="a919b22acaf4c3355330a895d349449e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a919b22acaf4c3355330a895d349449e0">&#9670;&nbsp;</a></span>HOSTCRYPTO_GenerateEccKey()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">U16 HOSTCRYPTO_GenerateEccKey </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="sm__types_8h.html#a2281a38532f01707192bc9a4b1d81c47">ECCCurve_t</a>&#160;</td>
          <td class="paramname"><em>curveType</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">EC_KEY **&#160;</td>
          <td class="paramname"><em>ppKey</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Create an ECC key (in an OpenSSL specific format) on the requested curve </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">curveType</td><td>E.g. ECCCurve_NIST_P256. Not all curves defined in <a class="el" href="sm__types_8h.html#a2281a38532f01707192bc9a4b1d81c47">ECCCurve_t</a> are always supported by the underlying OpenSSL crypto library. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ppKey</td><td>Double indirection to EC_KEY (OpenSSL) data structure. In case *ppKey already points to a key object, that object is freed first. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="tst_host_crypto_8c_source.html#l00348">348</a> of file <a class="el" href="tst_host_crypto_8c_source.html">tstHostCrypto.c</a>.</p>

</div>
</div>
<a id="a84eb3228f8d2c760d3816d171271114b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a84eb3228f8d2c760d3816d171271114b">&#9670;&nbsp;</a></span>HOSTCRYPTO_GetPrivateKey()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">U16 HOSTCRYPTO_GetPrivateKey </td>
          <td>(</td>
          <td class="paramtype">EC_KEY *&#160;</td>
          <td class="paramname"><em>pKey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">U8 *&#160;</td>
          <td class="paramname"><em>pPrivateKeyData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">U16 *&#160;</td>
          <td class="paramname"><em>pPrivateKeyLen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">U16&#160;</td>
          <td class="paramname"><em>maxPrivateKeyLen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Extract the private key - as a byte array restored to nominal key size by sign extension - from an ECC key (in an OpenSSL specific format) </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pKey</td><td>Reference to ECC key (OpenSSL). </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">pPrivateKeyData</td><td>IN: Buffer to contain private key; OUT: Private key </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pPrivateKeyLen</td><td>Length of private key <code>pPrivateKeyData</code> retrieved </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">maxPrivateKeyLen</td><td>Size of buffer (<code>pPrivateKeyData</code>) provided to contain private key </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="tst_host_crypto_8c_source.html#l00278">278</a> of file <a class="el" href="tst_host_crypto_8c_source.html">tstHostCrypto.c</a>.</p>

</div>
</div>
<a id="aca5363e321d6cdc668895445e0f40742"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aca5363e321d6cdc668895445e0f40742">&#9670;&nbsp;</a></span>HOSTCRYPTO_GetPublicKey()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">U16 HOSTCRYPTO_GetPublicKey </td>
          <td>(</td>
          <td class="paramtype">EC_KEY *&#160;</td>
          <td class="paramname"><em>pKey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">U8 *&#160;</td>
          <td class="paramname"><em>pPublicKeyData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">U16 *&#160;</td>
          <td class="paramname"><em>pPublicKeyLen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">U16&#160;</td>
          <td class="paramname"><em>maxPublicKeyLen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Extract the public key - as a byte array in uncompress format - from an ECC key (in an OpenSSL specific format) </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pKey</td><td>Reference to ECC key (OpenSSL). </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">pPublicKeyData</td><td>IN: Buffer to contain public key; OUT: Public key </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pPublicKeyLen</td><td>Length of public key <code>pPublicKeyData</code> retrieved </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">maxPublicKeyLen</td><td>Size of buffer (<code>pPublicKeyData</code>) provided to contain public key </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="tst_host_crypto_8c_source.html#l00250">250</a> of file <a class="el" href="tst_host_crypto_8c_source.html">tstHostCrypto.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_334bf0e2cc3331174eefb01118a0a83d.html">hostLib</a></li><li class="navelem"><a class="el" href="dir_dd2e802081fdc15787911b7d412848c9.html">tstUtil</a></li><li class="navelem"><a class="el" href="tst_host_crypto_8c.html">tstHostCrypto.c</a></li>
    <li class="footer">Generated on Fri Sep 7 2018 19:24:07 for A71CH Host Sw by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
