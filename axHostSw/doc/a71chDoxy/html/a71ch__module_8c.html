<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>A71CH Host Sw: C:/ubuntu_exchange/axHostSw/hostLib/a71ch/src/a71ch_module.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">A71CH Host Sw
   &#160;<span id="projectnumber">v01.05.00</span>
   </div>
   <div id="projectbrief">NXP Semiconductors</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('a71ch__module_8c.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">a71ch_module.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;assert.h&gt;</code><br />
<code>#include &quot;<a class="el" href="scp_8h_source.html">scp.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="a71ch__api_8h_source.html">a71ch_api.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="sm__apdu_8h_source.html">sm_apdu.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="sm__errors_8h_source.html">sm_errors.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="ax__common__private_8h_source.html">ax_common_private.h</a>&quot;</code><br />
</div>
<p><a href="a71ch__module_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a4f2b4f9054d09fb70f338378d83f49c7"><td class="memItemLeft" align="right" valign="top">U16&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a71ch__module_8c.html#a4f2b4f9054d09fb70f338378d83f49c7">A71_GetCredentialInfo</a> (U8 *map, U16 *mapLen)</td></tr>
<tr class="separator:a4f2b4f9054d09fb70f338378d83f49c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a19636edae2f396d811293bd62e1027b0"><td class="memItemLeft" align="right" valign="top">U16&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a71ch__module_8c.html#a19636edae2f396d811293bd62e1027b0">A71_GetModuleInfo</a> (U16 *selectResponse, U8 *debugOn, U8 *restrictedKpIdx, U8 *transportLockState, U8 *scpState, U8 *injectLockState, U16 *gpStorageSize)</td></tr>
<tr class="separator:a19636edae2f396d811293bd62e1027b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa49fa7dd012527b91fce9e0b7cb08602"><td class="memItemLeft" align="right" valign="top">U16&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a71ch__module_8c.html#aa49fa7dd012527b91fce9e0b7cb08602">A71_GetUniqueID</a> (U8 *uid, U16 *uidLen)</td></tr>
<tr class="separator:aa49fa7dd012527b91fce9e0b7cb08602"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87d2b03f80b90a7e037396dc840e6922"><td class="memItemLeft" align="right" valign="top">U16&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a71ch__module_8c.html#a87d2b03f80b90a7e037396dc840e6922">A71_GetCertUid</a> (U8 *certUid, U16 *certUidLen)</td></tr>
<tr class="separator:a87d2b03f80b90a7e037396dc840e6922"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1504b46b3aa3c29b9b67cd33e566ccdc"><td class="memItemLeft" align="right" valign="top">U16&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a71ch__module_8c.html#a1504b46b3aa3c29b9b67cd33e566ccdc">A71_GetUnlockChallenge</a> (U8 *challenge, U16 *challengeLen)</td></tr>
<tr class="separator:a1504b46b3aa3c29b9b67cd33e566ccdc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d33d068de51cbbd3983a3ccb20bc43c"><td class="memItemLeft" align="right" valign="top">U16&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a71ch__module_8c.html#a7d33d068de51cbbd3983a3ccb20bc43c">A71_GetKeyPairChallenge</a> (U8 *challenge, U16 *challengeLen)</td></tr>
<tr class="separator:a7d33d068de51cbbd3983a3ccb20bc43c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8bb62a87bebbe76c8e1c241dfbce8881"><td class="memItemLeft" align="right" valign="top">U16&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a71ch__module_8c.html#a8bb62a87bebbe76c8e1c241dfbce8881">A71_GetPublicKeyChallenge</a> (U8 *challenge, U16 *challengeLen)</td></tr>
<tr class="separator:a8bb62a87bebbe76c8e1c241dfbce8881"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afcc55dd1ff7e1bcc1525e84938ae6a94"><td class="memItemLeft" align="right" valign="top">U16&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a71ch__module_8c.html#afcc55dd1ff7e1bcc1525e84938ae6a94">A71_GetRandom</a> (U8 *random, U8 randomLen)</td></tr>
<tr class="separator:afcc55dd1ff7e1bcc1525e84938ae6a94"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a41482fb30f0889dda031ca304347b36a"><td class="memItemLeft" align="right" valign="top">U16&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a71ch__module_8c.html#a41482fb30f0889dda031ca304347b36a">A71_CreateClientHelloRandom</a> (U8 *clientHello, U8 clientHelloLen)</td></tr>
<tr class="separator:a41482fb30f0889dda031ca304347b36a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23bd95ee502289ca5e99a7988ec8cb01"><td class="memItemLeft" align="right" valign="top">U16&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a71ch__module_8c.html#a23bd95ee502289ca5e99a7988ec8cb01">A71_GetRestrictedKeyPairInfo</a> (U8 *idx, U16 *nBlocks, U8 *blockInfo, U16 *blockInfoLen)</td></tr>
<tr class="separator:a23bd95ee502289ca5e99a7988ec8cb01"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7086b9fd318633e82c8890f10f5e2a25"><td class="memItemLeft" align="right" valign="top">U16&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a71ch__module_8c.html#a7086b9fd318633e82c8890f10f5e2a25">A71_GetSha256</a> (U8 *data, U16 dataLen, U8 *sha, U16 *shaLen)</td></tr>
<tr class="separator:a7086b9fd318633e82c8890f10f5e2a25"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad1806a1c51382e5a5bdda363879b0d05"><td class="memItemLeft" align="right" valign="top">U16&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a71ch__module_8c.html#ad1806a1c51382e5a5bdda363879b0d05">A71_InjectLock</a> ()</td></tr>
<tr class="separator:ad1806a1c51382e5a5bdda363879b0d05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a976d66744e0b864269465f9ceff412a4"><td class="memItemLeft" align="right" valign="top">U16&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a71ch__module_8c.html#a976d66744e0b864269465f9ceff412a4">A71_LockModule</a> ()</td></tr>
<tr class="separator:a976d66744e0b864269465f9ceff412a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1311235f1ddebe255d1b8e074dc819f0"><td class="memItemLeft" align="right" valign="top">U16&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a71ch__module_8c.html#a1311235f1ddebe255d1b8e074dc819f0">A71_UnlockModule</a> (U8 *code, U16 codeLen)</td></tr>
<tr class="separator:a1311235f1ddebe255d1b8e074dc819f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a613ce459466d0fbd6b46ee2324875b9c"><td class="memItemLeft" align="right" valign="top">U16&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a71ch__module_8c.html#a613ce459466d0fbd6b46ee2324875b9c">A71_SetTlsLabel</a> (const U8 *label, U16 labelLen)</td></tr>
<tr class="separator:a613ce459466d0fbd6b46ee2324875b9c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab4ea82d6235ac722b7e1dc835eae8551"><td class="memItemLeft" align="right" valign="top">U16&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a71ch__module_8c.html#ab4ea82d6235ac722b7e1dc835eae8551">A71_EccVerifyWithKey</a> (const U8 *pKeyData, U16 keyDataLen, const U8 *pHash, U16 hashLen, const U8 *pSignature, U16 signatureLen, U8 *pResult)</td></tr>
<tr class="separator:ab4ea82d6235ac722b7e1dc835eae8551"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><dl class="section author"><dt>Author</dt><dd>NXP Semiconductors </dd></dl>
<dl class="section version"><dt>Version</dt><dd>1.0 </dd></dl>
<dl class="section user"><dt>License</dt><dd>Copyright 2016 NXP</dd></dl>
<p>This software is owned or controlled by NXP and may only be used strictly in accordance with the applicable license terms. By expressly accepting such terms or by downloading, installing, activating and/or otherwise using the software, you are agreeing that you have read, and that you agree to comply with and are bound by, such license terms. If you do not agree to be bound by the applicable license terms, then you may not retain, install, activate or otherwise use the software.</p>
<dl class="section user"><dt>Description</dt><dd>This file wraps the module centric APDU functionality of the A71CH module. </dd></dl>
<dl class="section user"><dt>History</dt><dd>1.0 2016-aug-29 : Initial version </dd></dl>

<p class="definition">Definition in file <a class="el" href="a71ch__module_8c_source.html">a71ch_module.c</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a41482fb30f0889dda031ca304347b36a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a41482fb30f0889dda031ca304347b36a">&#9670;&nbsp;</a></span>A71_CreateClientHelloRandom()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">U16 A71_CreateClientHelloRandom </td>
          <td>(</td>
          <td class="paramtype">U8 *&#160;</td>
          <td class="paramname"><em>clientHello</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">U8&#160;</td>
          <td class="paramname"><em>clientHelloLen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Updates a 32 byte random value inside the A71CH and returns this value to the caller. </p><dl class="section post"><dt>Postcondition</dt><dd>A71CH is in a state it will accept <a class="el" href="a71ch__crypto__derive_8c.html#ab217a564829034e240abe4da32d1eb4e">A71_PskDeriveMasterSecret</a> or <a class="el" href="a71ch__crypto__derive_8c.html#a1c6754f6ead68081bc7d51c80e17f159">A71_EcdhPskDeriveMasterSecret</a> as an API call.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">clientHello</td><td>IN: buffer to contain random value (at least of size randomLen); OUT: retrieved random data </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">clientHelloLen</td><td>Amount of byte to retrieve (must be equal to <a class="el" href="a71ch__api_8h.html#a33c8250c2f7a99c31563a0003510fb12" title="Length (in byte) of TLS 1.2 Hello. ">AX_TLS_PSK_HELLO_RANDOM_LEN</a>) </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="sm__types_8h.html#a8c7b7be5dd3dcbaa85f9d9536fc93f55" title="Operation successfull. ">SW_OK</a></td><td>Upon successful execution </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="a71ch__module_8c_source.html#l00375">375</a> of file <a class="el" href="a71ch__module_8c_source.html">a71ch_module.c</a>.</p>

</div>
</div>
<a id="ab4ea82d6235ac722b7e1dc835eae8551"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab4ea82d6235ac722b7e1dc835eae8551">&#9670;&nbsp;</a></span>A71_EccVerifyWithKey()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">U16 A71_EccVerifyWithKey </td>
          <td>(</td>
          <td class="paramtype">const U8 *&#160;</td>
          <td class="paramname"><em>pKeyData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">U16&#160;</td>
          <td class="paramname"><em>keyDataLen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const U8 *&#160;</td>
          <td class="paramname"><em>pHash</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">U16&#160;</td>
          <td class="paramname"><em>hashLen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const U8 *&#160;</td>
          <td class="paramname"><em>pSignature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">U16&#160;</td>
          <td class="paramname"><em>signatureLen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">U8 *&#160;</td>
          <td class="paramname"><em>pResult</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Verifies whether <code>pSignature</code> is the signature of <code>pHash</code> using <code>pKeyData</code> as the verifying public key.</p>
<p>As opposed to function <a class="el" href="a71ch__crypto__ecc_8c.html#a487c69814972728b650acc9ac3c59d66">A71_EccVerify</a> the public key value is passed as an argument to the A71CH.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pKeyData</td><td>Public key passed as byte array in ANSI X9.62 uncompressed format </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">keyDataLen</td><td>Length of public key passed as argument </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pHash</td><td>Pointer to the provided hash (or any other bytestring). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hashLen</td><td>Length of the provided hash. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pSignature</td><td>Pointer to the provided signature. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">signatureLen</td><td>Length of the provided signature. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pResult</td><td>Pointer to the computed result of the verification. Points to a value of 0x01 in case of successful verification </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="sm__types_8h.html#a8c7b7be5dd3dcbaa85f9d9536fc93f55" title="Operation successfull. ">SW_OK</a></td><td>Upon successful execution </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="a71ch__module_8c_source.html#l00787">787</a> of file <a class="el" href="a71ch__module_8c_source.html">a71ch_module.c</a>.</p>

</div>
</div>
<a id="a87d2b03f80b90a7e037396dc840e6922"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a87d2b03f80b90a7e037396dc840e6922">&#9670;&nbsp;</a></span>A71_GetCertUid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">U16 A71_GetCertUid </td>
          <td>(</td>
          <td class="paramtype">U8 *&#160;</td>
          <td class="paramname"><em>certUid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">U16 *&#160;</td>
          <td class="paramname"><em>certUidLen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get cert uid from the Secure Module. The cert uid is a subset of the Secure Module Unique Identifier </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">certUid</td><td>IN: buffer to contain cert uid; OUT: cert uid retrieved from Secure Module </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">certUidLen</td><td>IN: Size of buffer provided (at least <a class="el" href="a71ch__api_8h.html#a375bcfe191a6d378de81db2132149517" title="Length (in byte) of cert unique identifier. ">A71CH_MODULE_CERT_UID_LEN</a> byte); OUT: length of retrieved unique identifier (expected to be <a class="el" href="a71ch__api_8h.html#a375bcfe191a6d378de81db2132149517" title="Length (in byte) of cert unique identifier. ">A71CH_MODULE_CERT_UID_LEN</a> byte)</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="sm__types_8h.html#a8c7b7be5dd3dcbaa85f9d9536fc93f55" title="Operation successfull. ">SW_OK</a></td><td>Upon successful execution </td></tr>
    <tr><td class="paramname"><a class="el" href="sm__types_8h.html#aee0fc528992d35eb42b06846f9322663" title="Semantic error discovered while parsing APDU response. ">ERR_WRONG_RESPONSE</a></td><td>In case the Secure Module Unique Identifier (i.e. the base uid) did not have the expected length </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="a71ch__module_8c_source.html#l00276">276</a> of file <a class="el" href="a71ch__module_8c_source.html">a71ch_module.c</a>.</p>

</div>
</div>
<a id="a4f2b4f9054d09fb70f338378d83f49c7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f2b4f9054d09fb70f338378d83f49c7">&#9670;&nbsp;</a></span>A71_GetCredentialInfo()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">U16 A71_GetCredentialInfo </td>
          <td>(</td>
          <td class="paramtype">U8 *&#160;</td>
          <td class="paramname"><em>map</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">U16 *&#160;</td>
          <td class="paramname"><em>mapLen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get credential info from Module (in raw format) </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">map</td><td></td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">mapLen</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="sm__types_8h.html#a8c7b7be5dd3dcbaa85f9d9536fc93f55" title="Operation successfull. ">SW_OK</a></td><td>Upon successful execution </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="a71ch__module_8c_source.html#l00118">118</a> of file <a class="el" href="a71ch__module_8c_source.html">a71ch_module.c</a>.</p>

</div>
</div>
<a id="a7d33d068de51cbbd3983a3ccb20bc43c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d33d068de51cbbd3983a3ccb20bc43c">&#9670;&nbsp;</a></span>A71_GetKeyPairChallenge()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">U16 A71_GetKeyPairChallenge </td>
          <td>(</td>
          <td class="paramtype">U8 *&#160;</td>
          <td class="paramname"><em>challenge</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">U16 *&#160;</td>
          <td class="paramname"><em>challengeLen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get Unlock challenge for a Keypair </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">challenge</td><td>IN: buffer to contain challenge; OUT: challenge retrieved from Secure Module </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">challengeLen</td><td>IN: Size of buffer provided (at least <a class="el" href="a71ch__api_8h.html#a5c25dc57d525ed82c6c3251cda86dc8a" title="Length (in byte) of challenge created by secure module to get it unlocked. ">A71CH_MODULE_UNLOCK_CHALLENGE_LEN</a> byte); OUT: length of retrieved unique identifier (must be <a class="el" href="a71ch__api_8h.html#a5c25dc57d525ed82c6c3251cda86dc8a" title="Length (in byte) of challenge created by secure module to get it unlocked. ">A71CH_MODULE_UNLOCK_CHALLENGE_LEN</a> byte) </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="sm__types_8h.html#a8c7b7be5dd3dcbaa85f9d9536fc93f55" title="Operation successfull. ">SW_OK</a></td><td>Upon successful execution </td></tr>
    <tr><td class="paramname"><a class="el" href="sm__types_8h.html#aee0fc528992d35eb42b06846f9322663" title="Semantic error discovered while parsing APDU response. ">ERR_WRONG_RESPONSE</a></td><td>In case an identifier with a length different from <a class="el" href="a71ch__api_8h.html#a5c25dc57d525ed82c6c3251cda86dc8a" title="Length (in byte) of challenge created by secure module to get it unlocked. ">A71CH_MODULE_UNLOCK_CHALLENGE_LEN</a> was retrieved </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="a71ch__module_8c_source.html#l00333">333</a> of file <a class="el" href="a71ch__module_8c_source.html">a71ch_module.c</a>.</p>

</div>
</div>
<a id="a19636edae2f396d811293bd62e1027b0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a19636edae2f396d811293bd62e1027b0">&#9670;&nbsp;</a></span>A71_GetModuleInfo()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">U16 A71_GetModuleInfo </td>
          <td>(</td>
          <td class="paramtype">U16 *&#160;</td>
          <td class="paramname"><em>selectResponse</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">U8 *&#160;</td>
          <td class="paramname"><em>debugOn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">U8 *&#160;</td>
          <td class="paramname"><em>restrictedKpIdx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">U8 *&#160;</td>
          <td class="paramname"><em>transportLockState</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">U8 *&#160;</td>
          <td class="paramname"><em>scpState</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">U8 *&#160;</td>
          <td class="paramname"><em>injectLockState</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">U16 *&#160;</td>
          <td class="paramname"><em>gpStorageSize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get info on Module </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">selectResponse</td><td>Encodes applet revision and whether Debug Mode is available </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">debugOn</td><td>Equals 0x01 when the Debug Mode is available </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">restrictedKpIdx</td><td>Either the index of the restricted keypair or <a class="el" href="a71ch__api_8h.html#adbb87cf7c6bc5eed08aebc9bdff8b815" title="No restricted keypairs available. ">A71CH_NO_RESTRICTED_KP</a> </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">transportLockState</td><td>The value retieved is one of <a class="el" href="a71ch__api_8h.html#a1d0dd929bf62e16ab4ac46277fb4552f" title="Transport Lock set. ">A71CH_TRANSPORT_LOCK_STATE_LOCKED</a>, A71CH_TRANSPORT_LOCK_STATE_UNLOCKED or A71CH_TRANSPORT_LOCK_STATE_ALLOW_LOCK </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">scpState</td><td>The value retrieved is on of <a class="el" href="a71ch__api_8h.html#a95eab8b48af85cfe4a7d60566b46bffa" title="After a successful GP_ExternalAuthenticate, the usage of SCP03 becomes MANDATORY. ...">A71CH_SCP_MANDATORY</a>, <a class="el" href="a71ch__api_8h.html#a5caab456d51267aa13c83201822de9c8" title="No SCP keys written. ">A71CH_SCP_NOT_SET_UP</a> or <a class="el" href="a71ch__api_8h.html#a8f3bfbfd047b3ada3e664e472215574c" title="Successfully written SCP keys (with GP_PutKey), SCP03 binding has not yet been set up...">A71CH_SCP_KEYS_SET</a> </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">injectLockState</td><td>The value retrieved is one of <a class="el" href="a71ch__api_8h.html#afaaf4af73b17748e039483fc6afddb7e" title="Locked. ">A71CH_INJECT_LOCK_STATE_LOCKED</a> or <a class="el" href="a71ch__api_8h.html#ad29a0942d1c669253ea67b927e86ea67" title="Unlocked. ">A71CH_INJECT_LOCK_STATE_UNLOCKED</a> </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">gpStorageSize</td><td>Total storage size (in byte) of the General Purpose data store </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="sm__types_8h.html#a8c7b7be5dd3dcbaa85f9d9536fc93f55" title="Operation successfull. ">SW_OK</a></td><td>Upon successful execution </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="a71ch__module_8c_source.html#l00168">168</a> of file <a class="el" href="a71ch__module_8c_source.html">a71ch_module.c</a>.</p>

</div>
</div>
<a id="a8bb62a87bebbe76c8e1c241dfbce8881"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8bb62a87bebbe76c8e1c241dfbce8881">&#9670;&nbsp;</a></span>A71_GetPublicKeyChallenge()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">U16 A71_GetPublicKeyChallenge </td>
          <td>(</td>
          <td class="paramtype">U8 *&#160;</td>
          <td class="paramname"><em>challenge</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">U16 *&#160;</td>
          <td class="paramname"><em>challengeLen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get Unlock challenge for a Public Key </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">challenge</td><td>IN: buffer to contain challenge; OUT: challenge retrieved from Secure Module </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">challengeLen</td><td>IN: Size of buffer provided (at least <a class="el" href="a71ch__api_8h.html#a5c25dc57d525ed82c6c3251cda86dc8a" title="Length (in byte) of challenge created by secure module to get it unlocked. ">A71CH_MODULE_UNLOCK_CHALLENGE_LEN</a> byte); OUT: length of retrieved unique identifier (must be <a class="el" href="a71ch__api_8h.html#a5c25dc57d525ed82c6c3251cda86dc8a" title="Length (in byte) of challenge created by secure module to get it unlocked. ">A71CH_MODULE_UNLOCK_CHALLENGE_LEN</a> byte) </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="sm__types_8h.html#a8c7b7be5dd3dcbaa85f9d9536fc93f55" title="Operation successfull. ">SW_OK</a></td><td>Upon successful execution </td></tr>
    <tr><td class="paramname"><a class="el" href="sm__types_8h.html#aee0fc528992d35eb42b06846f9322663" title="Semantic error discovered while parsing APDU response. ">ERR_WRONG_RESPONSE</a></td><td>In case an identifier with a length different from <a class="el" href="a71ch__api_8h.html#a5c25dc57d525ed82c6c3251cda86dc8a" title="Length (in byte) of challenge created by secure module to get it unlocked. ">A71CH_MODULE_UNLOCK_CHALLENGE_LEN</a> was retrieved </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="a71ch__module_8c_source.html#l00346">346</a> of file <a class="el" href="a71ch__module_8c_source.html">a71ch_module.c</a>.</p>

</div>
</div>
<a id="afcc55dd1ff7e1bcc1525e84938ae6a94"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afcc55dd1ff7e1bcc1525e84938ae6a94">&#9670;&nbsp;</a></span>A71_GetRandom()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">U16 A71_GetRandom </td>
          <td>(</td>
          <td class="paramtype">U8 *&#160;</td>
          <td class="paramname"><em>random</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">U8&#160;</td>
          <td class="paramname"><em>randomLen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Retrieves a random byte array of size randomLen from the Secure Module. The maximum amount of data that can be retrieved depends on whether an authenticated channel (SCP03) has been set up. In case SCP03 has been set up, this (worst-case) maximum is <a class="el" href="a71ch__api_8h.html#a1ccd230744941306c53848cfab7bfa01" title="Maximum size of command/response data in case SCP03 in enabled. ">A71CH_SCP03_MAX_PAYLOAD_SIZE</a> </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">random</td><td>IN: buffer to contain random value (at least of size randomLen); OUT: retrieved random data </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">randomLen</td><td>Amount of byte to retrieve </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="sm__types_8h.html#a8c7b7be5dd3dcbaa85f9d9536fc93f55" title="Operation successfull. ">SW_OK</a></td><td>Upon successful execution </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="a71ch__module_8c_source.html#l00361">361</a> of file <a class="el" href="a71ch__module_8c_source.html">a71ch_module.c</a>.</p>

</div>
</div>
<a id="a23bd95ee502289ca5e99a7988ec8cb01"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a23bd95ee502289ca5e99a7988ec8cb01">&#9670;&nbsp;</a></span>A71_GetRestrictedKeyPairInfo()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">U16 A71_GetRestrictedKeyPairInfo </td>
          <td>(</td>
          <td class="paramtype">U8 *&#160;</td>
          <td class="paramname"><em>idx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">U16 *&#160;</td>
          <td class="paramname"><em>nBlocks</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">U8 *&#160;</td>
          <td class="paramname"><em>blockInfo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">U16 *&#160;</td>
          <td class="paramname"><em>blockInfoLen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get the index of the restricted key pair (<code>idx</code>) together with the number of modifiable blocks (<code>nBlocks</code>) in the locked GP storage area that is associated with the restricted key pair. Detailed info on block offset and block length is contained in the <code>blockInfo</code> byte array. Per block 2 bytes indicate the offset into GP storage and two bytes indicate the length of the modifiable block.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">idx</td><td>Index of restricted key pair. <a class="el" href="a71ch__api_8h.html#adbb87cf7c6bc5eed08aebc9bdff8b815" title="No restricted keypairs available. ">A71CH_NO_RESTRICTED_KP</a> in case there is no restricted key pair </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">nBlocks</td><td>Number of modifiable blocks </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">blockInfo</td><td>IN: Storage to contain blockInfo; OUT: Raw info on block offset and block lenght per block. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">blockInfoLen</td><td>IN: Size of blockInfo (in byte); OUT: effective size of blockInfo </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="sm__types_8h.html#a8c7b7be5dd3dcbaa85f9d9536fc93f55" title="Operation successfull. ">SW_OK</a></td><td>Upon successful execution </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="a71ch__module_8c_source.html#l00397">397</a> of file <a class="el" href="a71ch__module_8c_source.html">a71ch_module.c</a>.</p>

</div>
</div>
<a id="a7086b9fd318633e82c8890f10f5e2a25"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7086b9fd318633e82c8890f10f5e2a25">&#9670;&nbsp;</a></span>A71_GetSha256()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">U16 A71_GetSha256 </td>
          <td>(</td>
          <td class="paramtype">U8 *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">U16&#160;</td>
          <td class="paramname"><em>dataLen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">U8 *&#160;</td>
          <td class="paramname"><em>sha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">U16 *&#160;</td>
          <td class="paramname"><em>shaLen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calculates the SHA256 value of the data provided as input. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">data</td><td>Data buffer for which the SHA256 must be calculated </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dataLen</td><td>The length of data passed as argument </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">sha</td><td>IN: caller passes a buffer of at least 32 byte; OUT: contains the calculated SHA256 </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">shaLen</td><td>IN: length of the sha buffer passed; OUT: because SHA256 is used this is 32 byte exact </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="sm__types_8h.html#a8c7b7be5dd3dcbaa85f9d9536fc93f55" title="Operation successfull. ">SW_OK</a></td><td>Upon successful execution </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="a71ch__module_8c_source.html#l00494">494</a> of file <a class="el" href="a71ch__module_8c_source.html">a71ch_module.c</a>.</p>

</div>
</div>
<a id="aa49fa7dd012527b91fce9e0b7cb08602"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa49fa7dd012527b91fce9e0b7cb08602">&#9670;&nbsp;</a></span>A71_GetUniqueID()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">U16 A71_GetUniqueID </td>
          <td>(</td>
          <td class="paramtype">U8 *&#160;</td>
          <td class="paramname"><em>uid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">U16 *&#160;</td>
          <td class="paramname"><em>uidLen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get Unique Identifier from the Secure Module </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">uid</td><td>IN: buffer to contain uid; OUT: uid retrieved from Secure Module </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">uidLen</td><td>IN: Size of buffer provided (at least <a class="el" href="a71ch__api_8h.html#a8b9a237f68c916d6bb2a4a64f6ac4cf3" title="Length (in byte) of unique identifier contained in secure module. ">A71CH_MODULE_UNIQUE_ID_LEN</a> byte); OUT: length of retrieved unique identifier (expected to be <a class="el" href="a71ch__api_8h.html#a8b9a237f68c916d6bb2a4a64f6ac4cf3" title="Length (in byte) of unique identifier contained in secure module. ">A71CH_MODULE_UNIQUE_ID_LEN</a> byte) </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="sm__types_8h.html#a8c7b7be5dd3dcbaa85f9d9536fc93f55" title="Operation successfull. ">SW_OK</a></td><td>Upon successful execution </td></tr>
    <tr><td class="paramname"><a class="el" href="sm__types_8h.html#aee0fc528992d35eb42b06846f9322663" title="Semantic error discovered while parsing APDU response. ">ERR_WRONG_RESPONSE</a></td><td>In case an identifier with a length different from <a class="el" href="a71ch__api_8h.html#a8b9a237f68c916d6bb2a4a64f6ac4cf3" title="Length (in byte) of unique identifier contained in secure module. ">A71CH_MODULE_UNIQUE_ID_LEN</a> was retrieved </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="a71ch__module_8c_source.html#l00229">229</a> of file <a class="el" href="a71ch__module_8c_source.html">a71ch_module.c</a>.</p>

</div>
</div>
<a id="a1504b46b3aa3c29b9b67cd33e566ccdc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1504b46b3aa3c29b9b67cd33e566ccdc">&#9670;&nbsp;</a></span>A71_GetUnlockChallenge()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">U16 A71_GetUnlockChallenge </td>
          <td>(</td>
          <td class="paramtype">U8 *&#160;</td>
          <td class="paramname"><em>challenge</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">U16 *&#160;</td>
          <td class="paramname"><em>challengeLen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get Unlock challenge from the Secure Module </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">challenge</td><td>IN: buffer to contain challenge; OUT: challenge retrieved from Secure Module </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">challengeLen</td><td>IN: Size of buffer provided (at least <a class="el" href="a71ch__api_8h.html#a5c25dc57d525ed82c6c3251cda86dc8a" title="Length (in byte) of challenge created by secure module to get it unlocked. ">A71CH_MODULE_UNLOCK_CHALLENGE_LEN</a> byte); OUT: length of retrieved unique identifier (must be <a class="el" href="a71ch__api_8h.html#a5c25dc57d525ed82c6c3251cda86dc8a" title="Length (in byte) of challenge created by secure module to get it unlocked. ">A71CH_MODULE_UNLOCK_CHALLENGE_LEN</a> byte) </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="sm__types_8h.html#a8c7b7be5dd3dcbaa85f9d9536fc93f55" title="Operation successfull. ">SW_OK</a></td><td>Upon successful execution </td></tr>
    <tr><td class="paramname"><a class="el" href="sm__types_8h.html#aee0fc528992d35eb42b06846f9322663" title="Semantic error discovered while parsing APDU response. ">ERR_WRONG_RESPONSE</a></td><td>In case an identifier with a length different from <a class="el" href="a71ch__api_8h.html#a5c25dc57d525ed82c6c3251cda86dc8a" title="Length (in byte) of challenge created by secure module to get it unlocked. ">A71CH_MODULE_UNLOCK_CHALLENGE_LEN</a> was retrieved </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="a71ch__module_8c_source.html#l00320">320</a> of file <a class="el" href="a71ch__module_8c_source.html">a71ch_module.c</a>.</p>

</div>
</div>
<a id="ad1806a1c51382e5a5bdda363879b0d05"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad1806a1c51382e5a5bdda363879b0d05">&#9670;&nbsp;</a></span>A71_InjectLock()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">U16 A71_InjectLock </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function disables - at device level - the ability to</p><ul>
<li>Set symmetric keys without prior wrapping</li>
<li>Erase symmetric keys</li>
<li>Set ECC key pairs (private key part) without prior wrapping</li>
<li>Set ECC public key without prior wrapping</li>
</ul>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="sm__types_8h.html#a8c7b7be5dd3dcbaa85f9d9536fc93f55" title="Operation successfull. ">SW_OK</a></td><td>Upon successful execution </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="a71ch__module_8c_source.html#l00624">624</a> of file <a class="el" href="a71ch__module_8c_source.html">a71ch_module.c</a>.</p>

</div>
</div>
<a id="a976d66744e0b864269465f9ceff412a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a976d66744e0b864269465f9ceff412a4">&#9670;&nbsp;</a></span>A71_LockModule()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">U16 A71_LockModule </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function locks the module (typically to protect the module during transport to production facilities). When the A71CH is locked the functionality is reduced to the following subset:</p><ul>
<li><a class="el" href="a71ch__module_8c.html#aa49fa7dd012527b91fce9e0b7cb08602">A71_GetUniqueID</a></li>
<li><a class="el" href="a71ch__module_8c.html#a1504b46b3aa3c29b9b67cd33e566ccdc">A71_GetUnlockChallenge</a></li>
<li><a class="el" href="a71ch__module_8c.html#a1311235f1ddebe255d1b8e074dc819f0">A71_UnlockModule</a></li>
<li><a class="el" href="a71ch__module_8c.html#a19636edae2f396d811293bd62e1027b0">A71_GetModuleInfo</a></li>
</ul>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="sm__types_8h.html#a8c7b7be5dd3dcbaa85f9d9536fc93f55" title="Operation successfull. ">SW_OK</a></td><td>Upon successful execution </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="a71ch__module_8c_source.html#l00659">659</a> of file <a class="el" href="a71ch__module_8c_source.html">a71ch_module.c</a>.</p>

</div>
</div>
<a id="a613ce459466d0fbd6b46ee2324875b9c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a613ce459466d0fbd6b46ee2324875b9c">&#9670;&nbsp;</a></span>A71_SetTlsLabel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">U16 A71_SetTlsLabel </td>
          <td>(</td>
          <td class="paramtype">const U8 *&#160;</td>
          <td class="paramname"><em>label</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">U16&#160;</td>
          <td class="paramname"><em>labelLen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Sets the label that is used when calling <a class="el" href="a71ch__crypto__derive_8c.html#a1c6754f6ead68081bc7d51c80e17f159">A71_EcdhPskDeriveMasterSecret</a> or <a class="el" href="a71ch__crypto__derive_8c.html#ab217a564829034e240abe4da32d1eb4e">A71_PskDeriveMasterSecret</a>. Calling this function is optional. By default the label used by the A71CH is <code>'master</code> secret' (no quotes) as applicable for TLS 1.2. The maximum size of the label that can be set is 24 byte. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">label</td><td>Value to be stored and used as 'label' in TLS 1.2 protocol </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">labelLen</td><td>Length of label (less than or equal to <a class="el" href="a71ch__api_8h.html#ae75fbb56d3ab53da9409d79f002b86d9" title="Maximum size of label that can be stored in A71CH. ">A71CH_TLS_MAX_LABEL</a>) </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="sm__types_8h.html#a8c7b7be5dd3dcbaa85f9d9536fc93f55" title="Operation successfull. ">SW_OK</a></td><td>Upon successful execution </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="a71ch__module_8c_source.html#l00738">738</a> of file <a class="el" href="a71ch__module_8c_source.html">a71ch_module.c</a>.</p>

</div>
</div>
<a id="a1311235f1ddebe255d1b8e074dc819f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1311235f1ddebe255d1b8e074dc819f0">&#9670;&nbsp;</a></span>A71_UnlockModule()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">U16 A71_UnlockModule </td>
          <td>(</td>
          <td class="paramtype">U8 *&#160;</td>
          <td class="paramname"><em>code</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">U16&#160;</td>
          <td class="paramname"><em>codeLen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function unlocks the module provided the correct code is provided as input argument. The A71CH can only be unlocked once: if the device is already unlocked, the device cannot be locked or unlocked again (it will remain unlocked).</p>
<p>The unlock code is calculated as follows:</p><ul>
<li>Request a challenge from A71CH using <a class="el" href="a71ch__module_8c.html#a1504b46b3aa3c29b9b67cd33e566ccdc">A71_GetUnlockChallenge</a>.</li>
<li>Decrypt the challenge in ECB mode using the appropriate configuration key value (the same as stored at index <a class="el" href="a71ch__api_8h.html#af657713d01e18d2da21304aa8ac7e787" title="Index of Module Transport Lock configuration key. ">A71CH_CFG_KEY_IDX_MODULE_LOCK</a>).</li>
<li>The decrypted value is the unlock <code>code</code> <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">code</td><td>Value of unlock code </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">codeLen</td><td>Length of unlock code (must be 16) </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="sm__types_8h.html#a8c7b7be5dd3dcbaa85f9d9536fc93f55" title="Operation successfull. ">SW_OK</a></td><td>Upon successful execution </td></tr>
  </table>
  </dd>
</dl>
</li>
</ul>

<p class="definition">Definition at line <a class="el" href="a71ch__module_8c_source.html#l00697">697</a> of file <a class="el" href="a71ch__module_8c_source.html">a71ch_module.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_334bf0e2cc3331174eefb01118a0a83d.html">hostLib</a></li><li class="navelem"><a class="el" href="dir_ceffb261bb5d756d1931d3d27f14ec57.html">a71ch</a></li><li class="navelem"><a class="el" href="dir_aea1d74edf7334533e1d37ace23cdbae.html">src</a></li><li class="navelem"><a class="el" href="a71ch__module_8c.html">a71ch_module.c</a></li>
    <li class="footer">Generated on Fri Sep 7 2018 19:24:07 for A71CH Host Sw by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
