<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>A71CH Host Sw: C:/ubuntu_exchange/axHostSw/hostLib/api/src/ax_scp.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">A71CH Host Sw
   &#160;<span id="projectnumber">v01.05.00</span>
   </div>
   <div id="projectbrief">NXP Semiconductors</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('ax__scp_8c.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">ax_scp.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;stdint.h&gt;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;assert.h&gt;</code><br />
<code>#include &quot;<a class="el" href="ax__api_8h_source.html">ax_api.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="sm__apdu_8h_source.html">sm_apdu.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="sm__errors_8h_source.html">sm_errors.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_host_crypto_a_p_i_8h_source.html">HostCryptoAPI.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="ax__util_8h_source.html">ax_util.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="global__platf_8h_source.html">global_platf.h</a>&quot;</code><br />
</div>
<p><a href="ax__scp_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a8bc6aa45a01084b7f70262dfeaf7098b"><td class="memItemLeft" align="right" valign="top"><a id="a8bc6aa45a01084b7f70262dfeaf7098b"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ax__scp_8c.html#a8bc6aa45a01084b7f70262dfeaf7098b">ERROR_VERBOSE</a></td></tr>
<tr class="memdesc:a8bc6aa45a01084b7f70262dfeaf7098b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Define to enable reporting of error messages. <br /></td></tr>
<tr class="separator:a8bc6aa45a01084b7f70262dfeaf7098b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a7abf858ba4277b02a7220c6a276207dc"><td class="memItemLeft" align="right" valign="top"><a id="a7abf858ba4277b02a7220c6a276207dc"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>DEV_setDataDerivationArray</b> (U8 ddA[], U16 *pDdALen, U8 ddConstant, U16 ddL, U8 iCounter, U8 *context, U16 contextLen)</td></tr>
<tr class="separator:a7abf858ba4277b02a7220c6a276207dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ec301fb6bf30496bef8855777718678"><td class="memItemLeft" align="right" valign="top"><a id="a4ec301fb6bf30496bef8855777718678"></a>
U16&#160;</td><td class="memItemRight" valign="bottom"><b>SCP_HostLocal_SetDefaultValueIcvCCounter</b> (<a class="el" href="ax__common_8h.html#a5d91bed5cf0c10f84a157ec3ebc4aa75">ChannelId_t</a> channelId)</td></tr>
<tr class="separator:a4ec301fb6bf30496bef8855777718678"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a955e61322e66d1e6f0ee3bfd391d66cf"><td class="memItemLeft" align="right" valign="top"><a id="a955e61322e66d1e6f0ee3bfd391d66cf"></a>
U16&#160;</td><td class="memItemRight" valign="bottom"><b>SCP_HostLocal_IncIcvCCounter</b> (<a class="el" href="ax__common_8h.html#a5d91bed5cf0c10f84a157ec3ebc4aa75">ChannelId_t</a> channelId)</td></tr>
<tr class="separator:a955e61322e66d1e6f0ee3bfd391d66cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a253c789dddc7983a15386564a5b134e2"><td class="memItemLeft" align="right" valign="top"><a id="a253c789dddc7983a15386564a5b134e2"></a>
U16&#160;</td><td class="memItemRight" valign="bottom"><b>SCP_HostLocal_SetKeysScp</b> (<a class="el" href="ax__common_8h.html#a5d91bed5cf0c10f84a157ec3ebc4aa75">ChannelId_t</a> channelId, U8 *keyEnc, U8 *keyMac, U8 *keyDek, U16 keyBytes)</td></tr>
<tr class="separator:a253c789dddc7983a15386564a5b134e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5689bc6ef2d001d7c70e18719e6c7e2"><td class="memItemLeft" align="right" valign="top"><a id="ae5689bc6ef2d001d7c70e18719e6c7e2"></a>
U16&#160;</td><td class="memItemRight" valign="bottom"><b>SCP_HostLocal_GetKeyDek</b> (<a class="el" href="ax__common_8h.html#a5d91bed5cf0c10f84a157ec3ebc4aa75">ChannelId_t</a> channelId, U8 *keyDek)</td></tr>
<tr class="separator:ae5689bc6ef2d001d7c70e18719e6c7e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a70d9133aaeaf6789974ca36565a8b35a"><td class="memItemLeft" align="right" valign="top"><a id="a70d9133aaeaf6789974ca36565a8b35a"></a>
U16&#160;</td><td class="memItemRight" valign="bottom"><b>SCP_HostLocal_GetKeyEnc</b> (<a class="el" href="ax__common_8h.html#a5d91bed5cf0c10f84a157ec3ebc4aa75">ChannelId_t</a> channelId, U8 *keyEnc)</td></tr>
<tr class="separator:a70d9133aaeaf6789974ca36565a8b35a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ad8825724a39907ee077d604149d8d6"><td class="memItemLeft" align="right" valign="top"><a id="a4ad8825724a39907ee077d604149d8d6"></a>
U16&#160;</td><td class="memItemRight" valign="bottom"><b>SCP_HostLocal_GetKeyMac</b> (<a class="el" href="ax__common_8h.html#a5d91bed5cf0c10f84a157ec3ebc4aa75">ChannelId_t</a> channelId, U8 *keyMac)</td></tr>
<tr class="separator:a4ad8825724a39907ee077d604149d8d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7428c648894a221a76be206ed1842585"><td class="memItemLeft" align="right" valign="top"><a id="a7428c648894a221a76be206ed1842585"></a>
U16&#160;</td><td class="memItemRight" valign="bottom"><b>SCP_HostLocal_ResetMacChainingValue</b> (<a class="el" href="ax__common_8h.html#a5d91bed5cf0c10f84a157ec3ebc4aa75">ChannelId_t</a> channelId)</td></tr>
<tr class="separator:a7428c648894a221a76be206ed1842585"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1cd2962e4ea6ebd2481ff24b816381c1"><td class="memItemLeft" align="right" valign="top"><a id="a1cd2962e4ea6ebd2481ff24b816381c1"></a>
U16&#160;</td><td class="memItemRight" valign="bottom"><b>SCP_HostLocal_SetMacChainingValue</b> (<a class="el" href="ax__common_8h.html#a5d91bed5cf0c10f84a157ec3ebc4aa75">ChannelId_t</a> channelId, U8 *mcv)</td></tr>
<tr class="separator:a1cd2962e4ea6ebd2481ff24b816381c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb20c9272c7beb8d18ac20da75e93220"><td class="memItemLeft" align="right" valign="top">U16&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ax__scp_8c.html#aeb20c9272c7beb8d18ac20da75e93220">SCP_HostLocal_GetSessionState</a> (<a class="el" href="ax__common_8h.html#a5d91bed5cf0c10f84a157ec3ebc4aa75">ChannelId_t</a> channelId, <a class="el" href="struct_scp03_session_state__t.html">Scp03SessionState_t</a> *pSession)</td></tr>
<tr class="separator:aeb20c9272c7beb8d18ac20da75e93220"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35525a8019e4ee9e6f93fe1d09dcdeb3"><td class="memItemLeft" align="right" valign="top"><a id="a35525a8019e4ee9e6f93fe1d09dcdeb3"></a>
U16&#160;</td><td class="memItemRight" valign="bottom"><b>SCP_HostLocal_CalculateSessionKeys</b> (<a class="el" href="ax__common_8h.html#a5d91bed5cf0c10f84a157ec3ebc4aa75">ChannelId_t</a> channelId, U8 *hostChallenge, U8 *cardChallenge)</td></tr>
<tr class="separator:a35525a8019e4ee9e6f93fe1d09dcdeb3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d7edb72db5612a22b00377ba7459c3d"><td class="memItemLeft" align="right" valign="top"><a id="a4d7edb72db5612a22b00377ba7459c3d"></a>
U16&#160;</td><td class="memItemRight" valign="bottom"><b>SCP_HostLocal_CalculateHostCryptogram</b> (<a class="el" href="ax__common_8h.html#a5d91bed5cf0c10f84a157ec3ebc4aa75">ChannelId_t</a> channelId, U8 *hostChallenge, U8 *cardChallenge, U8 *hostCryptogram)</td></tr>
<tr class="separator:a4d7edb72db5612a22b00377ba7459c3d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17875f525b7282838eb056a127be770d"><td class="memItemLeft" align="right" valign="top"><a id="a17875f525b7282838eb056a127be770d"></a>
U16&#160;</td><td class="memItemRight" valign="bottom"><b>SCP_HostLocal_VerifyCardCryptogram</b> (<a class="el" href="ax__common_8h.html#a5d91bed5cf0c10f84a157ec3ebc4aa75">ChannelId_t</a> channelId, U8 *hostChallenge, U8 *cardChallenge, U8 *cardCryptogram)</td></tr>
<tr class="separator:a17875f525b7282838eb056a127be770d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a57da2ee4aa097de3837e8fbea74c340b"><td class="memItemLeft" align="right" valign="top">U16&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ax__scp_8c.html#a57da2ee4aa097de3837e8fbea74c340b">SCP_GetScpSessionState</a> (<a class="el" href="struct_scp03_session_state__t.html">Scp03SessionState_t</a> *scp03state)</td></tr>
<tr class="separator:a57da2ee4aa097de3837e8fbea74c340b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac97cd829442a0ad4afa95a9f0d228b6c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ax__scp_8c.html#ac97cd829442a0ad4afa95a9f0d228b6c">SCP_SetScpSessionState</a> (<a class="el" href="struct_scp03_session_state__t.html">Scp03SessionState_t</a> *scp03state)</td></tr>
<tr class="separator:ac97cd829442a0ad4afa95a9f0d228b6c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a730c2a3c0b5210a8beea618d1eba0422"><td class="memItemLeft" align="right" valign="top"><a id="a730c2a3c0b5210a8beea618d1eba0422"></a>
U16&#160;</td><td class="memItemRight" valign="bottom"><b>SCP_GP_ExternalAuthenticate</b> (<a class="el" href="ax__common_8h.html#a5d91bed5cf0c10f84a157ec3ebc4aa75">ChannelId_t</a> channelId, U8 *hostCryptogram)</td></tr>
<tr class="separator:a730c2a3c0b5210a8beea618d1eba0422"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2da2408a54dc9ecf1a8ce5c47c93b273"><td class="memItemLeft" align="right" valign="top"><a id="a2da2408a54dc9ecf1a8ce5c47c93b273"></a>
U16&#160;</td><td class="memItemRight" valign="bottom"><b>SCP_GP_InitializeUpdate</b> (<a class="el" href="ax__common_8h.html#a5d91bed5cf0c10f84a157ec3ebc4aa75">ChannelId_t</a> channelId, U8 *hostChallenge, U16 hostChallengeLen, U8 *keyDivData, U16 *pKeyDivDataLen, U8 *keyInfo, U16 *pKeyInfoLen, U8 *cardChallenge, U16 *pCardChallengeLen, U8 *cardCryptoGram, U16 *pCardCryptoGramLen, U8 *seqCounter, U16 *pSeqCounterLen)</td></tr>
<tr class="separator:a2da2408a54dc9ecf1a8ce5c47c93b273"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0161c72666aae8b70d4f9be8d56b8ea1"><td class="memItemLeft" align="right" valign="top">static U8&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ax__scp_8c.html#a0161c72666aae8b70d4f9be8d56b8ea1">createKeyDataField</a> (U8 keyType, U8 *key, U8 *currentKeyDek, U8 *targetStore, S32 *nCryptoStatus)</td></tr>
<tr class="separator:a0161c72666aae8b70d4f9be8d56b8ea1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a968a39902216088c5aadccb74d0bb7a4"><td class="memItemLeft" align="right" valign="top">U16&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ax__scp_8c.html#a968a39902216088c5aadccb74d0bb7a4">SCP_GP_PutKeys</a> (U8 keyVersion, U8 *keyEnc, U8 *keyMac, U8 *keyDek, U8 *currentKeyDek, U16 keyBytes)</td></tr>
<tr class="separator:a968a39902216088c5aadccb74d0bb7a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4756d3338d24f95b25c5959e7c671776"><td class="memItemLeft" align="right" valign="top">U16&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ax__scp_8c.html#a4756d3338d24f95b25c5959e7c671776">SCP_Authenticate</a> (U8 *keyEnc, U8 *keyMac, U8 *keyDek, U16 keyBytes, U8 *sCounter, U16 *sCounterLen)</td></tr>
<tr class="separator:a4756d3338d24f95b25c5959e7c671776"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a0ba994b75bb7a34a4a9b77f999da5f77"><td class="memItemLeft" align="right" valign="top"><a id="a0ba994b75bb7a34a4a9b77f999da5f77"></a>
static <a class="el" href="struct_scp_state__t.html">ScpState_t</a>&#160;</td><td class="memItemRight" valign="bottom"><b>scpState</b> [2]</td></tr>
<tr class="separator:a0ba994b75bb7a34a4a9b77f999da5f77"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><dl class="section author"><dt>Author</dt><dd>NXP Semiconductors </dd></dl>
<dl class="section version"><dt>Version</dt><dd>1.0 </dd></dl>
<dl class="section user"><dt>License</dt><dd>Copyright 2016 NXP</dd></dl>
<p>This software is owned or controlled by NXP and may only be used strictly in accordance with the applicable license terms. By expressly accepting such terms or by downloading, installing, activating and/or otherwise using the software, you are agreeing that you have read, and that you agree to comply with and are bound by, such license terms. If you do not agree to be bound by the applicable license terms, then you may not retain, install, activate or otherwise use the software.</p>
<dl class="section user"><dt>Description</dt><dd>This file implements the setting up of the SCP03 communication channel. </dd></dl>
<dl class="section note"><dt>Note</dt><dd>Execution flow and Error messages can be sent to the console by defining FLOW_VERBOSE and ERROR_VERBOSE respectively at the start of the source code file. </dd></dl>
<dl class="section user"><dt>History</dt><dd>1.0 26-march-2014 : Initial version </dd></dl>

<p class="definition">Definition in file <a class="el" href="ax__scp_8c_source.html">ax_scp.c</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a0161c72666aae8b70d4f9be8d56b8ea1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0161c72666aae8b70d4f9be8d56b8ea1">&#9670;&nbsp;</a></span>createKeyDataField()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static U8 createKeyDataField </td>
          <td>(</td>
          <td class="paramtype">U8&#160;</td>
          <td class="paramname"><em>keyType</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">U8 *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">U8 *&#160;</td>
          <td class="paramname"><em>currentKeyDek</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">U8 *&#160;</td>
          <td class="paramname"><em>targetStore</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">S32 *&#160;</td>
          <td class="paramname"><em>nCryptoStatus</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Utility function used by <a class="el" href="ax__scp_8c.html#a968a39902216088c5aadccb74d0bb7a4">SCP_GP_PutKeys</a> </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">keyType</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">key</td><td>Pointer to the key </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">currentKeyDek</td><td>Pointer to the current Dek key, in case the pointer is NULL no encryption will be applied (deviates from GP spec to enable initial provisioning) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">targetStore</td><td></td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">nCryptoStatus</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Length </dd></dl>

<p class="definition">Definition at line <a class="el" href="ax__scp_8c_source.html#l00747">747</a> of file <a class="el" href="ax__scp_8c_source.html">ax_scp.c</a>.</p>

</div>
</div>
<a id="a4756d3338d24f95b25c5959e7c671776"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4756d3338d24f95b25c5959e7c671776">&#9670;&nbsp;</a></span>SCP_Authenticate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">U16 SCP_Authenticate </td>
          <td>(</td>
          <td class="paramtype">U8 *&#160;</td>
          <td class="paramname"><em>keyEnc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">U8 *&#160;</td>
          <td class="paramname"><em>keyMac</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">U8 *&#160;</td>
          <td class="paramname"><em>keyDek</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">U16&#160;</td>
          <td class="paramname"><em>keyBytes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">U8 *&#160;</td>
          <td class="paramname"><em>sCounter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">U16 *&#160;</td>
          <td class="paramname"><em>sCounterLen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Performs an SCP03 authentication with the SM and - when successful - computes the SCP03 session keys and initializes the current Session state.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">keyEnc</td><td>SCP03 channel encryption base key (aka static key) (16 bytes) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">keyMac</td><td>SCP03 authentication base key (aka static key) (16 bytes) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">keyDek</td><td>SCP03 data encryption base key (aka static key) (16 bytes) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">keyBytes</td><td>Must be 16 </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">sCounter</td><td>SCP03 sequence counter (3 bytes) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">sCounterLen</td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="ax__scp_8c_source.html#l00996">996</a> of file <a class="el" href="ax__scp_8c_source.html">ax_scp.c</a>.</p>

</div>
</div>
<a id="a57da2ee4aa097de3837e8fbea74c340b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a57da2ee4aa097de3837e8fbea74c340b">&#9670;&nbsp;</a></span>SCP_GetScpSessionState()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">U16 SCP_GetScpSessionState </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_scp03_session_state__t.html">Scp03SessionState_t</a> *&#160;</td>
          <td class="paramname"><em>scp03state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Retrieve the SCP03 session state of the host - secure module channel from the Host Library.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">scp03state</td><td>IN: pointer to allocated structure; OUT: datastructure contains SCP03 session state </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="sm__types_8h.html#a8c7b7be5dd3dcbaa85f9d9536fc93f55" title="Operation successfull. ">SW_OK</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="ax__scp_8c_source.html#l00495">495</a> of file <a class="el" href="ax__scp_8c_source.html">ax_scp.c</a>.</p>

</div>
</div>
<a id="a968a39902216088c5aadccb74d0bb7a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a968a39902216088c5aadccb74d0bb7a4">&#9670;&nbsp;</a></span>SCP_GP_PutKeys()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">U16 SCP_GP_PutKeys </td>
          <td>(</td>
          <td class="paramtype">U8&#160;</td>
          <td class="paramname"><em>keyVersion</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">U8 *&#160;</td>
          <td class="paramname"><em>keyEnc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">U8 *&#160;</td>
          <td class="paramname"><em>keyMac</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">U8 *&#160;</td>
          <td class="paramname"><em>keyDek</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">U8 *&#160;</td>
          <td class="paramname"><em>currentKeyDek</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">U16&#160;</td>
          <td class="paramname"><em>keyBytes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Persistently stores the provided SCP03 base key set in the security module.</p>
<p>This method must be called once before the Host - Secure Module SCP channel can be established.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">keyVersion</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">keyEnc</td><td>SCP03 channel encryption base key </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">keyMac</td><td>SCP03 authentication base key </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">keyDek</td><td>SCP03 data encryption base key </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">currentKeyDek</td><td>Value of the data encryption base key already stored in secure module, may be NULL in case no key is currently stored. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">keyBytes</td><td>Length (in byte) of the keys being set. Typically 16 (corresponding to 128 bits) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="sm__types_8h.html#a8c7b7be5dd3dcbaa85f9d9536fc93f55" title="Operation successfull. ">SW_OK</a> upon success </dd></dl>

<p class="definition">Definition at line <a class="el" href="ax__scp_8c_source.html#l00811">811</a> of file <a class="el" href="ax__scp_8c_source.html">ax_scp.c</a>.</p>

</div>
</div>
<a id="aeb20c9272c7beb8d18ac20da75e93220"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb20c9272c7beb8d18ac20da75e93220">&#9670;&nbsp;</a></span>SCP_HostLocal_GetSessionState()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">U16 SCP_HostLocal_GetSessionState </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ax__common_8h.html#a5d91bed5cf0c10f84a157ec3ebc4aa75">ChannelId_t</a>&#160;</td>
          <td class="paramname"><em>channelId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_scp03_session_state__t.html">Scp03SessionState_t</a> *&#160;</td>
          <td class="paramname"><em>pSession</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Copy the session state into <code>pSession</code>. Caller must allocate memory of <code>pSession</code>. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">channelId</td><td>Either <a class="el" href="ax__common_8h.html#a195a7ddd48d9272f9c533686c72b49bcac08ae9ceecd77863b53ddf4f097ab0a2" title="SCP03 channel identifier. ">AX_HOST_CHANNEL</a> or <a class="el" href="ax__common_8h.html#a195a7ddd48d9272f9c533686c72b49bca77603959b99490f6e0442029094d8d6f" title="SCP03 channel identifier. ">AX_ADMIN_CHANNEL</a>. Must be <a class="el" href="ax__common_8h.html#a195a7ddd48d9272f9c533686c72b49bcac08ae9ceecd77863b53ddf4f097ab0a2" title="SCP03 channel identifier. ">AX_HOST_CHANNEL</a> in case of A71CH. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">pSession</td><td>IN: pointer to allocated <a class="el" href="struct_scp03_session_state__t.html">Scp03SessionState_t</a> structure; OUT: retrieved state </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="sm__types_8h.html#a8c7b7be5dd3dcbaa85f9d9536fc93f55" title="Operation successfull. ">SW_OK</a></td><td>Upon successful execution </td></tr>
    <tr><td class="paramname"><a class="el" href="sm__types_8h.html#afa26509a949c208c342bf50033485acf" title="Undefined SCP channel identifier. ">SCP_UNDEFINED_CHANNEL_ID</a></td><td>In case an undefined <a class="el" href="ax__common_8h.html#a5d91bed5cf0c10f84a157ec3ebc4aa75">ChannelId_t</a> type was passed as parameter </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="ax__scp_8c_source.html#l00286">286</a> of file <a class="el" href="ax__scp_8c_source.html">ax_scp.c</a>.</p>

</div>
</div>
<a id="ac97cd829442a0ad4afa95a9f0d228b6c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac97cd829442a0ad4afa95a9f0d228b6c">&#9670;&nbsp;</a></span>SCP_SetScpSessionState()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SCP_SetScpSessionState </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_scp03_session_state__t.html">Scp03SessionState_t</a> *&#160;</td>
          <td class="paramname"><em>scp03state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Sets SCP03 session state of the host - secure module channel of the Host Library. Can be used in a scenario where e.g. the bootloader has established the SCP03 link between host and secure module and the Host OS must re-establish the communication with the secure module without breaking the SCP03 session.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">scp03state</td><td>IN: SCP03 session state </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="ax__scp_8c_source.html#l00517">517</a> of file <a class="el" href="ax__scp_8c_source.html">ax_scp.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_334bf0e2cc3331174eefb01118a0a83d.html">hostLib</a></li><li class="navelem"><a class="el" href="dir_5743dbf917946c5f85635b33d373f1a2.html">api</a></li><li class="navelem"><a class="el" href="dir_e6b7543e0cb522b0417d73586e2a3800.html">src</a></li><li class="navelem"><a class="el" href="ax__scp_8c.html">ax_scp.c</a></li>
    <li class="footer">Generated on Fri Sep 7 2018 19:24:07 for A71CH Host Sw by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
