<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>A71CH Host Sw: C:/ubuntu_exchange/axHostSw/hostLib/a71ch/ex_hlse/ex_hlse_cert.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">A71CH Host Sw
   &#160;<span id="projectnumber">v01.05.00</span>
   </div>
   <div id="projectbrief">NXP Semiconductors</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('ex__hlse__cert_8c.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">ex_hlse_cert.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;assert.h&gt;</code><br />
<code>#include &quot;sm_printf.h&quot;</code><br />
<code>#include &quot;<a class="el" href="_h_l_s_e_a_p_i_8h_source.html">HLSEAPI.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="sm__types_8h_source.html">sm_types.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="sm__apdu_8h_source.html">sm_apdu.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="tst__sm__util_8h_source.html">tst_sm_util.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="tst__a71ch__util_8h_source.html">tst_a71ch_util.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="tst__hlse__a71ch__util_8h_source.html">tst_hlse_a71ch_util.h</a>&quot;</code><br />
</div>
<p><a href="ex__hlse__cert_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a7ba7efe692e0283990b428b1e707043c"><td class="memItemLeft" align="right" valign="top"><a id="a7ba7efe692e0283990b428b1e707043c"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>N_ADV_CERT</b>&#160;&#160;&#160;255</td></tr>
<tr class="separator:a7ba7efe692e0283990b428b1e707043c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a9bccfac97c80a690e4e6a30cebc96d"><td class="memItemLeft" align="right" valign="top"><a id="a7a9bccfac97c80a690e4e6a30cebc96d"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>MAX_ADV_CERT_SIZE</b>&#160;&#160;&#160;(4096 - 32)</td></tr>
<tr class="separator:a7a9bccfac97c80a690e4e6a30cebc96d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a15c33bf1ebd6bc47d06aec32018fdd30"><td class="memItemLeft" align="right" valign="top"><a id="a15c33bf1ebd6bc47d06aec32018fdd30"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>LEN_SHORT_FORM_MAX</b>&#160;&#160;&#160;127</td></tr>
<tr class="separator:a15c33bf1ebd6bc47d06aec32018fdd30"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a644f84f62020eeb20105f09f2a958d8b"><td class="memItemLeft" align="right" valign="top"><a id="a644f84f62020eeb20105f09f2a958d8b"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>LEN_LONG_FORM_ONE_BYTE_MAX</b>&#160;&#160;&#160;255</td></tr>
<tr class="separator:a644f84f62020eeb20105f09f2a958d8b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aafede19a8224b66f29596ef10ac69d8d"><td class="memItemLeft" align="right" valign="top"><a id="aafede19a8224b66f29596ef10ac69d8d"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>LEN_LONG_FORM_TWO_BYTE_MAX</b>&#160;&#160;&#160;65536</td></tr>
<tr class="separator:aafede19a8224b66f29596ef10ac69d8d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac93d99b5d0c13701ed50da6dd2a005a9"><td class="memItemLeft" align="right" valign="top"><a id="ac93d99b5d0c13701ed50da6dd2a005a9"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>ERR_GP_NO_CERT</b>&#160;&#160;&#160;0x2000</td></tr>
<tr class="separator:ac93d99b5d0c13701ed50da6dd2a005a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a6bad56ca077ca7b71b3d238ba8e3b8ac"><td class="memItemLeft" align="right" valign="top">static U8&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ex__hlse__cert_8c.html#a6bad56ca077ca7b71b3d238ba8e3b8ac">exDataObjUsage</a> (U8 initMode)</td></tr>
<tr class="separator:a6bad56ca077ca7b71b3d238ba8e3b8ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d3cedaef7872e8557b23af32b9cd19e"><td class="memItemLeft" align="right" valign="top">static U8&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ex__hlse__cert_8c.html#a9d3cedaef7872e8557b23af32b9cd19e">exMixedCertsAndDataObj</a> (U8 initMode, U16 nBaseSize, U16 nObj)</td></tr>
<tr class="separator:a9d3cedaef7872e8557b23af32b9cd19e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8a5ea15e0e64c3a66429008525c631c"><td class="memItemLeft" align="right" valign="top">static U8&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ex__hlse__cert_8c.html#ab8a5ea15e0e64c3a66429008525c631c">exCertUsageBasic</a> (U8 initMode)</td></tr>
<tr class="separator:ab8a5ea15e0e64c3a66429008525c631c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a819114ceb50fc08bba26bec85d2569a2"><td class="memItemLeft" align="right" valign="top">static U8&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ex__hlse__cert_8c.html#a819114ceb50fc08bba26bec85d2569a2">exCertUsageEnlarge</a> (U8 initMode)</td></tr>
<tr class="separator:a819114ceb50fc08bba26bec85d2569a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3b41b59eefbdc665e1dd03bc442f075"><td class="memItemLeft" align="right" valign="top">static U8&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ex__hlse__cert_8c.html#ad3b41b59eefbdc665e1dd03bc442f075">exCertUsageGpTableLengthUnknown</a> (U8 initMode)</td></tr>
<tr class="separator:ad3b41b59eefbdc665e1dd03bc442f075"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e1f782ec51835134b0fcfb6adfa5339"><td class="memItemLeft" align="right" valign="top">static U8&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ex__hlse__cert_8c.html#a4e1f782ec51835134b0fcfb6adfa5339">exCertUsageReadOnly</a> (U8 initMode)</td></tr>
<tr class="separator:a4e1f782ec51835134b0fcfb6adfa5339"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a27a628208abaf60c49276c3edfb9cbd6"><td class="memItemLeft" align="right" valign="top">static U8&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ex__hlse__cert_8c.html#a27a628208abaf60c49276c3edfb9cbd6">exCertEnumerate</a> (void)</td></tr>
<tr class="separator:a27a628208abaf60c49276c3edfb9cbd6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab06b22590b7a3b1df2424a7a86333801"><td class="memItemLeft" align="right" valign="top">static U8&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ex__hlse__cert_8c.html#ab06b22590b7a3b1df2424a7a86333801">exCertGetAttr</a> (void)</td></tr>
<tr class="separator:ab06b22590b7a3b1df2424a7a86333801"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4f2695e4cad797221ad5563c08aaa2d"><td class="memItemLeft" align="right" valign="top">static U8&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ex__hlse__cert_8c.html#ac4f2695e4cad797221ad5563c08aaa2d">exCertSetAttr</a> (void)</td></tr>
<tr class="separator:ac4f2695e4cad797221ad5563c08aaa2d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1098d18bf786d57f460bfaf2389986d9"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="group__ghlse__types.html#gad08b6cf58499e5abe79fd24b1927fb67">HLSE_RET_CODE</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ex__hlse__cert_8c.html#a1098d18bf786d57f460bfaf2389986d9">patchCertificateInitialTL</a> (U8 *clientCertDer, U16 clientCertDerLen)</td></tr>
<tr class="separator:a1098d18bf786d57f460bfaf2389986d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1ec2b7ea719a9edd429887165d4c0c7"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="group__ghlse__types.html#gad08b6cf58499e5abe79fd24b1927fb67">HLSE_RET_CODE</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ex__hlse__cert_8c.html#ae1ec2b7ea719a9edd429887165d4c0c7">getObject</a> (<a class="el" href="group__ghlse__types.html#ga151970919e95335f3e870a47aa313c23">HLSE_OBJECT_HANDLE</a> handle, U8 *data, U16 *len)</td></tr>
<tr class="separator:ae1ec2b7ea719a9edd429887165d4c0c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee285c2d9f76e77ba0525045ebf22ba8"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="group__ghlse__types.html#gad08b6cf58499e5abe79fd24b1927fb67">HLSE_RET_CODE</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ex__hlse__cert_8c.html#aee285c2d9f76e77ba0525045ebf22ba8">setObject</a> (<a class="el" href="group__ghlse__types.html#ga151970919e95335f3e870a47aa313c23">HLSE_OBJECT_HANDLE</a> handle, U8 *data, U16 len)</td></tr>
<tr class="separator:aee285c2d9f76e77ba0525045ebf22ba8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc982f6b05e2f7c098f4e1963036b8f0"><td class="memItemLeft" align="right" valign="top">U8&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ex__hlse__cert_8c.html#acc982f6b05e2f7c098f4e1963036b8f0">exHlseCert</a> ()</td></tr>
<tr class="separator:acc982f6b05e2f7c098f4e1963036b8f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><dl class="section author"><dt>Author</dt><dd>NXP Semiconductors </dd></dl>
<dl class="section version"><dt>Version</dt><dd>1.0 </dd></dl>
<dl class="section user"><dt>License</dt><dd>Copyright 2018 NXP</dd></dl>
<p>This software is owned or controlled by NXP and may only be used strictly in accordance with the applicable license terms. By expressly accepting such terms or by downloading, installing, activating and/or otherwise using the software, you are agreeing that you have read, and that you agree to comply with and are bound by, such license terms. If you do not agree to be bound by the applicable license terms, then you may not retain, install, activate or otherwise use the software.</p>
<dl class="section user"><dt>Description</dt><dd>Example using Certificate objects </dd></dl>

<p class="definition">Definition in file <a class="el" href="ex__hlse__cert_8c_source.html">ex_hlse_cert.c</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a27a628208abaf60c49276c3edfb9cbd6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a27a628208abaf60c49276c3edfb9cbd6">&#9670;&nbsp;</a></span>exCertEnumerate()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static U8 exCertEnumerate </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Internal function , called from <a class="el" href="ex__hlse__cert_8c.html#a4e1f782ec51835134b0fcfb6adfa5339">exCertUsageReadOnly()</a></p>
<p>Demonstrate</p><ul>
<li>using <a class="el" href="_h_l_s_e_objects_8h.html#a9ca5b6eedab2e1482f2c1827b5b9c4c4">HLSE_EnumerateObjects()</a> for certificate enumeration</li>
<li>using <a class="el" href="_h_l_s_e_objects_8h.html#aed82a75832750f0d93937897e1980ec4">HLSE_GetObjectAttribute()</a> to get certificate tag </li>
</ul>

<p class="definition">Definition at line <a class="el" href="ex__hlse__cert_8c_source.html#l01532">1532</a> of file <a class="el" href="ex__hlse__cert_8c_source.html">ex_hlse_cert.c</a>.</p>

</div>
</div>
<a id="ab06b22590b7a3b1df2424a7a86333801"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab06b22590b7a3b1df2424a7a86333801">&#9670;&nbsp;</a></span>exCertGetAttr()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static U8 exCertGetAttr </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Internal function , called from <a class="el" href="ex__hlse__cert_8c.html#a4e1f782ec51835134b0fcfb6adfa5339">exCertUsageReadOnly()</a></p>
<p>Demonstrate</p><ul>
<li>using <a class="el" href="_h_l_s_e_objects_8h.html#a9ca5b6eedab2e1482f2c1827b5b9c4c4">HLSE_EnumerateObjects()</a> for certificate enumeration</li>
<li>using <a class="el" href="_h_l_s_e_objects_8h.html#aed82a75832750f0d93937897e1980ec4">HLSE_GetObjectAttribute()</a> with HLSE_ATTR_OBJECT_VALUE to get object's value </li>
</ul>

<p class="definition">Definition at line <a class="el" href="ex__hlse__cert_8c_source.html#l01571">1571</a> of file <a class="el" href="ex__hlse__cert_8c_source.html">ex_hlse_cert.c</a>.</p>

</div>
</div>
<a id="ac4f2695e4cad797221ad5563c08aaa2d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac4f2695e4cad797221ad5563c08aaa2d">&#9670;&nbsp;</a></span>exCertSetAttr()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static U8 exCertSetAttr </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Demonstrate</p><ul>
<li>using <a class="el" href="_h_l_s_e_objects_8h.html#a9ca5b6eedab2e1482f2c1827b5b9c4c4">HLSE_EnumerateObjects()</a> for certificate enumeration</li>
<li>shows using <a class="el" href="_h_l_s_e_objects_8h.html#a36fe72bc902d0e484fda14dc75d4c34f">HLSE_SetObjectAttribute()</a> to change an object's value fails when credential is frozen </li>
</ul>

<p class="definition">Definition at line <a class="el" href="ex__hlse__cert_8c_source.html#l01608">1608</a> of file <a class="el" href="ex__hlse__cert_8c_source.html">ex_hlse_cert.c</a>.</p>

</div>
</div>
<a id="ab8a5ea15e0e64c3a66429008525c631c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab8a5ea15e0e64c3a66429008525c631c">&#9670;&nbsp;</a></span>exCertUsageBasic()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static U8 exCertUsageBasic </td>
          <td>(</td>
          <td class="paramtype">U8&#160;</td>
          <td class="paramname"><em>initMode</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Demonstrate usage of certificate object:</p>
<p>Simulate the following scenario and aim to verify it works correctly:</p>
<ul>
<li>Create Certificate</li>
<li>Read certificate data and verify correctness<ul>
<li>Index ok</li>
<li>Value was correctly set</li>
</ul>
</li>
<li>Update Certificate contents</li>
<li>Verify Certificate updated correctly</li>
<li>Delete certificate</li>
<li>Verify deletion</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">initMode</td><td>Visit the documentation of <a class="el" href="tst__a71ch__util_8c.html#a4777eab8462a47aedf4a809f20f4a799">a71chInitModule</a> for more information on this parameter </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="ex__hlse__cert_8c_source.html#l00104">104</a> of file <a class="el" href="ex__hlse__cert_8c_source.html">ex_hlse_cert.c</a>.</p>

</div>
</div>
<a id="a819114ceb50fc08bba26bec85d2569a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a819114ceb50fc08bba26bec85d2569a2">&#9670;&nbsp;</a></span>exCertUsageEnlarge()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static U8 exCertUsageEnlarge </td>
          <td>(</td>
          <td class="paramtype">U8&#160;</td>
          <td class="paramname"><em>initMode</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Demonstrate usage of certificate objects:</p>
<p>Simulate the following scenario and aim to verify it works correctly:</p>
<ul>
<li>Create certificates</li>
<li>Verify cannot create additional certificate</li>
<li>Verify allows to enlarge a certificate with size within allocated boundary</li>
<li>Verify cannot enlarge beyond the allocated boundary</li>
<li>Delete the certificate</li>
<li>Recreate it with bigger size</li>
<li>Verify last certificate created still exists</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">initMode</td><td>Visit the documentation of <a class="el" href="tst__a71ch__util_8c.html#a4777eab8462a47aedf4a809f20f4a799">a71chInitModule</a> for more information on this parameter </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="ex__hlse__cert_8c_source.html#l00837">837</a> of file <a class="el" href="ex__hlse__cert_8c_source.html">ex_hlse_cert.c</a>.</p>

</div>
</div>
<a id="ad3b41b59eefbdc665e1dd03bc442f075"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad3b41b59eefbdc665e1dd03bc442f075">&#9670;&nbsp;</a></span>exCertUsageGpTableLengthUnknown()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static U8 exCertUsageGpTableLengthUnknown </td>
          <td>(</td>
          <td class="paramtype">U8&#160;</td>
          <td class="paramname"><em>initMode</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Demonstrate usage of certificate objects:</p>
<p>this example Verifies correct operation in case when length of certificate object was Unknown at the time the mapping table was created</p>
<p>Detailed explanation :</p>
<ul>
<li>The abstraction for various objects that reside in the GP Storage area is achieved by maintaining a lookup table (mapping) at the end of the GP Storage area to holds information about the logical objects that exist in the GP Storage</li>
<li>The gp table is rewritten(whole) each time an object is inserted or deleted</li>
<li>Each object is aligned to occupy at least the amount of memory on the boundary of the GP storage, that is 32 bytes. E.g. an object of 17 bytes will occupy 32 bytes</li>
</ul>
<p>In cases where the length of an object is not known at the time the table entry is set, the MSBit (0x8000) will be set in the length as an indicator for the host library to know that the data is in TLV format and that the actual length can be obtained by reading the first bytes of the object's data.</p>
<p>Example pre setup required:</p>
<ul>
<li>We want to have a single certificate at offset 0 in the GP storage</li>
<li>we want to have a mapping table with one entry in which the length of the certificate object is unknown.</li>
</ul>
<p>Simulate the following scenario to verify it works correctly:</p>
<ul>
<li>Create A Mapping table with one entry with length unknown as follows:</li>
</ul>
<pre class="fragment">*
*      Notes:
*          X+1 is the address of the last byte of the GP Storage.
*          N is the object number from 1 to N
*
*      Address     Value
*      -------     ----------------------
*      X-1*6+0     First Object Class      - 1 byte    value : 0
*      X-1*6+1     First Object Index      - 1 byte    value : 0
*      X-1*6+2     First Object Length MSB - 1 byte    value : 0x80    ( 0x8000 the MSBit Indicates Indirect length)
*      X-1*6+3     First Object Length LSB - 1 byte    value : 0x00
*      X-1*6+4     First Object Offset MSB - 1 byte    value : 0
*      X-1*6+5     First Object Offset LSB - 1 byte    value : 0
*      X           Update Counter          - 1 byte    value : 1
*      X+1         Number of table entries - 1 byte    value : 1
*      End of GP Storage
*
* </pre><ul>
<li>Write simulated certificate object at offset 0 of gp storage use TLV length encoded length:<ul>
<li>2 bytes 0x81, 0x..</li>
<li>3 bytes 0x82, 0x00, 0x..</li>
</ul>
</li>
<li>Read certificate data and verify correctness<ul>
<li>index ok</li>
<li>value was correctly set</li>
</ul>
</li>
<li>Update Certificate contents</li>
<li>Verify Certificate Updated correctly</li>
<li>Delete certificate</li>
<li>Verify deletion</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">initMode</td><td>Visit the documentation of <a class="el" href="tst__a71ch__util_8c.html#a4777eab8462a47aedf4a809f20f4a799">a71chInitModule</a> for more information on this parameter </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="ex__hlse__cert_8c_source.html#l01187">1187</a> of file <a class="el" href="ex__hlse__cert_8c_source.html">ex_hlse_cert.c</a>.</p>

</div>
</div>
<a id="a4e1f782ec51835134b0fcfb6adfa5339"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4e1f782ec51835134b0fcfb6adfa5339">&#9670;&nbsp;</a></span>exCertUsageReadOnly()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static U8 exCertUsageReadOnly </td>
          <td>(</td>
          <td class="paramtype">U8&#160;</td>
          <td class="paramname"><em>initMode</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Demonstrate</p>
<ul>
<li>Creating 3 read only certificates</li>
<li>Verify erasure of existing cert is disallowed since it's Read Only</li>
<li>Verify recreation of existing cert is disallowed since it's Read Only</li>
<li>Certificate Enumeration</li>
<li>Get Certificate value</li>
<li>Verify unable to update certificate value since it's Read Only</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">initMode</td><td>Visit the documentation of <a class="el" href="tst__a71ch__util_8c.html#a4777eab8462a47aedf4a809f20f4a799">a71chInitModule</a> for more information on this parameter </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="ex__hlse__cert_8c_source.html#l01437">1437</a> of file <a class="el" href="ex__hlse__cert_8c_source.html">ex_hlse_cert.c</a>.</p>

</div>
</div>
<a id="a6bad56ca077ca7b71b3d238ba8e3b8ac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6bad56ca077ca7b71b3d238ba8e3b8ac">&#9670;&nbsp;</a></span>exDataObjUsage()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static U8 exDataObjUsage </td>
          <td>(</td>
          <td class="paramtype">U8&#160;</td>
          <td class="paramname"><em>initMode</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Demonstrate usage of a data object:</p>
<p>Simulate the following scenario and aim to verify it works correctly:</p>
<ul>
<li>Create Data Object</li>
<li>Shows how to obtain the object GP offset</li>
<li>Read Data object and verify correctness<ul>
<li>Index ok</li>
<li>Value was correctly set</li>
</ul>
</li>
<li>Update Data Object contents</li>
<li>Verify Data Object updated correctly</li>
<li>Show direct update of partial block in Data Object</li>
<li>Show direct read of partial block in Data Object</li>
<li>Show direct Read / Write with offset that exceeds object boundaries is not allowed</li>
<li>Show direct Read / Write with length that exceeds object boundaries is not allowed</li>
<li>Delete Data Object</li>
<li>Verify deletion</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">initMode</td><td>Visit the documentation of <a class="el" href="tst__a71ch__util_8c.html#a4777eab8462a47aedf4a809f20f4a799">a71chInitModule</a> for more information on this parameter </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="ex__hlse__cert_8c_source.html#l00273">273</a> of file <a class="el" href="ex__hlse__cert_8c_source.html">ex_hlse_cert.c</a>.</p>

</div>
</div>
<a id="acc982f6b05e2f7c098f4e1963036b8f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acc982f6b05e2f7c098f4e1963036b8f0">&#9670;&nbsp;</a></span>exHlseCert()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">U8 exHlseCert </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Demonstrate usage of certificate objects </p>

<p class="definition">Definition at line <a class="el" href="ex__hlse__cert_8c_source.html#l00055">55</a> of file <a class="el" href="ex__hlse__cert_8c_source.html">ex_hlse_cert.c</a>.</p>

</div>
</div>
<a id="a9d3cedaef7872e8557b23af32b9cd19e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9d3cedaef7872e8557b23af32b9cd19e">&#9670;&nbsp;</a></span>exMixedCertsAndDataObj()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static U8 exMixedCertsAndDataObj </td>
          <td>(</td>
          <td class="paramtype">U8&#160;</td>
          <td class="paramname"><em>initMode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">U16&#160;</td>
          <td class="paramname"><em>nBaseSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">U16&#160;</td>
          <td class="paramname"><em>nObj</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>An Example to show usage of mixed certificates and data objects</p>
<p>Scenario:</p><ul>
<li>Create certificates and data objects</li>
<li>Read back the certificate and data objects<ul>
<li>verify objects exists</li>
<li>verify object's length matches</li>
<li>verify objects's data matches</li>
</ul>
</li>
<li>Delete a random number of objects</li>
<li>Read back the remaining certificate and data objects<ul>
<li>verify objects exists</li>
<li>verify object's length matches</li>
<li>verify objects's data matches</li>
</ul>
</li>
<li>Update an objects with new data</li>
<li>Read back the remaining certificate and data objects<ul>
<li>verify objects exists</li>
<li>verify object's length matches</li>
<li>verify objects's data matches</li>
</ul>
</li>
<li>Delete all objects</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">initMode</td><td>Visit the documentation of <a class="el" href="tst__a71ch__util_8c.html#a4777eab8462a47aedf4a809f20f4a799">a71chInitModule</a> for more information on this parameter </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nBaseSize</td><td>base size of Cert/Data object to create </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nObj</td><td>number of total objects to create </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="ex__hlse__cert_8c_source.html#l00553">553</a> of file <a class="el" href="ex__hlse__cert_8c_source.html">ex_hlse_cert.c</a>.</p>

</div>
</div>
<a id="ae1ec2b7ea719a9edd429887165d4c0c7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae1ec2b7ea719a9edd429887165d4c0c7">&#9670;&nbsp;</a></span>getObject()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="group__ghlse__types.html#gad08b6cf58499e5abe79fd24b1927fb67">HLSE_RET_CODE</a> getObject </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__ghlse__types.html#ga151970919e95335f3e870a47aa313c23">HLSE_OBJECT_HANDLE</a>&#160;</td>
          <td class="paramname"><em>handle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">U8 *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">U16 *&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Internal - called from exMixedCertsAndDataObjUsage Get an object's value and length based on based on object handle provided</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">handle</td><td>object handle </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">data</td><td>buffer to store object's value retrieved </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">len</td><td>in - length of data buffer, out - actual object's length </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="ex__hlse__cert_8c_source.html#l01707">1707</a> of file <a class="el" href="ex__hlse__cert_8c_source.html">ex_hlse_cert.c</a>.</p>

</div>
</div>
<a id="a1098d18bf786d57f460bfaf2389986d9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1098d18bf786d57f460bfaf2389986d9">&#9670;&nbsp;</a></span>patchCertificateInitialTL()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="group__ghlse__types.html#gad08b6cf58499e5abe79fd24b1927fb67">HLSE_RET_CODE</a> patchCertificateInitialTL </td>
          <td>(</td>
          <td class="paramtype">U8 *&#160;</td>
          <td class="paramname"><em>clientCertDer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">U16&#160;</td>
          <td class="paramname"><em>clientCertDerLen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Internal utility to patch the TLV header of a data buffer so it contains the certificate header TLV correct</p>
<p>A certificate header consists of the 0x30 tag followes by a length which could be encoded as 1) one byte: the length byte in case of length &lt;= 127 2) 2 bytes : 0x81 followed byte the length byte in case 127 &lt; length &lt;= 255 3) 3 bytes : 0x82 followed by 2 bytes length otherwise </p>

<p class="definition">Definition at line <a class="el" href="ex__hlse__cert_8c_source.html#l01670">1670</a> of file <a class="el" href="ex__hlse__cert_8c_source.html">ex_hlse_cert.c</a>.</p>

</div>
</div>
<a id="aee285c2d9f76e77ba0525045ebf22ba8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aee285c2d9f76e77ba0525045ebf22ba8">&#9670;&nbsp;</a></span>setObject()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="group__ghlse__types.html#gad08b6cf58499e5abe79fd24b1927fb67">HLSE_RET_CODE</a> setObject </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__ghlse__types.html#ga151970919e95335f3e870a47aa313c23">HLSE_OBJECT_HANDLE</a>&#160;</td>
          <td class="paramname"><em>handle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">U8 *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">U16&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Internal - called from exMixedCertsAndDataObjUsage Set a Certificate or Data object's value based on on object handle provided</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">handle</td><td>object handle </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">data</td><td>buffer of data to set obj value </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">len</td><td>in - length of data buffer </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="ex__hlse__cert_8c_source.html#l01761">1761</a> of file <a class="el" href="ex__hlse__cert_8c_source.html">ex_hlse_cert.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_334bf0e2cc3331174eefb01118a0a83d.html">hostLib</a></li><li class="navelem"><a class="el" href="dir_ceffb261bb5d756d1931d3d27f14ec57.html">a71ch</a></li><li class="navelem"><a class="el" href="dir_e94cd5e3ba4be26f16cb3bf8eb907b85.html">ex_hlse</a></li><li class="navelem"><a class="el" href="ex__hlse__cert_8c.html">ex_hlse_cert.c</a></li>
    <li class="footer">Generated on Fri Sep 7 2018 19:24:07 for A71CH Host Sw by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
