<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>A71CH Host Sw: C:/ubuntu_exchange/axHostSw/hostLib/a71ch/src/a71ch_crypto_ecc.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">A71CH Host Sw
   &#160;<span id="projectnumber">v01.05.00</span>
   </div>
   <div id="projectbrief">NXP Semiconductors</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('a71ch__crypto__ecc_8c.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">a71ch_crypto_ecc.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;assert.h&gt;</code><br />
<code>#include &quot;<a class="el" href="a71ch__api_8h_source.html">a71ch_api.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="sm__apdu_8h_source.html">sm_apdu.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="sm__errors_8h_source.html">sm_errors.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="hc_asn_8h_source.html">hcAsn.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="ax_host_crypto_8h_source.html">axHostCrypto.h</a>&quot;</code><br />
</div>
<p><a href="a71ch__crypto__ecc_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a8b9fc4efa629ccbd080260788b6e4ad2"><td class="memItemLeft" align="right" valign="top">U16&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a71ch__crypto__ecc_8c.html#a8b9fc4efa629ccbd080260788b6e4ad2">A71_GenerateEccKeyPair</a> (SST_Index_t index)</td></tr>
<tr class="separator:a8b9fc4efa629ccbd080260788b6e4ad2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b6b20abac676f3524b0df14ccba9f8a"><td class="memItemLeft" align="right" valign="top">U16&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a71ch__crypto__ecc_8c.html#a8b6b20abac676f3524b0df14ccba9f8a">A71_GenerateEccKeyPairWithChallenge</a> (SST_Index_t index, const U8 *configKey, U16 configKeyLen)</td></tr>
<tr class="separator:a8b6b20abac676f3524b0df14ccba9f8a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0cef809f0f15c9c1416e64a55cfa784b"><td class="memItemLeft" align="right" valign="top">U16&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a71ch__crypto__ecc_8c.html#a0cef809f0f15c9c1416e64a55cfa784b">A71_GenerateEccKeyPairWithCode</a> (SST_Index_t index, const U8 *code, U16 codeLen)</td></tr>
<tr class="separator:a0cef809f0f15c9c1416e64a55cfa784b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92370ab35f373f9fe2707cfb512ab679"><td class="memItemLeft" align="right" valign="top">U16&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a71ch__crypto__ecc_8c.html#a92370ab35f373f9fe2707cfb512ab679">A71_EccSign</a> (SST_Index_t index, const U8 *pHash, U16 hashLen, U8 *pSignature, U16 *pSignatureLen)</td></tr>
<tr class="separator:a92370ab35f373f9fe2707cfb512ab679"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe1b6c3407c141921525f3396bc4e5ff"><td class="memItemLeft" align="right" valign="top">U16&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a71ch__crypto__ecc_8c.html#abe1b6c3407c141921525f3396bc4e5ff">A71_EccNormalizedAsnSign</a> (SST_Index_t index, const U8 *pHash, U16 hashLen, U8 *pSignature, U16 *pSignatureLen)</td></tr>
<tr class="separator:abe1b6c3407c141921525f3396bc4e5ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6fa02cd309a1428d04680e3cef1e8bbd"><td class="memItemLeft" align="right" valign="top">U16&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a71ch__crypto__ecc_8c.html#a6fa02cd309a1428d04680e3cef1e8bbd">A71_EccRestrictedSign</a> (SST_Index_t index, const U8 *updateBytes, U16 updateBytesLen, U8 *invocationCount)</td></tr>
<tr class="separator:a6fa02cd309a1428d04680e3cef1e8bbd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a487c69814972728b650acc9ac3c59d66"><td class="memItemLeft" align="right" valign="top">U16&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a71ch__crypto__ecc_8c.html#a487c69814972728b650acc9ac3c59d66">A71_EccVerify</a> (SST_Index_t index, const U8 *pHash, U16 hashLen, const U8 *pSignature, U16 signatureLen, U8 *pResult)</td></tr>
<tr class="separator:a487c69814972728b650acc9ac3c59d66"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8141ee41a54b0ac74ab48ae13a0571a"><td class="memItemLeft" align="right" valign="top">U16&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a71ch__crypto__ecc_8c.html#af8141ee41a54b0ac74ab48ae13a0571a">A71_EcdhGetSharedSecret</a> (U8 index, const U8 *pOtherPublicKey, U16 otherPublicKeyLen, U8 *pSharedSecret, U16 *pSharedSecretLen)</td></tr>
<tr class="separator:af8141ee41a54b0ac74ab48ae13a0571a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><dl class="section author"><dt>Author</dt><dd>NXP Semiconductors </dd></dl>
<dl class="section version"><dt>Version</dt><dd>1.2 </dd></dl>
<dl class="section user"><dt>License</dt><dd>Copyright 2017 NXP</dd></dl>
<p>This software is owned or controlled by NXP and may only be used strictly in accordance with the applicable license terms. By expressly accepting such terms or by downloading, installing, activating and/or otherwise using the software, you are agreeing that you have read, and that you agree to comply with and are bound by, such license terms. If you do not agree to be bound by the applicable license terms, then you may not retain, install, activate or otherwise use the software.</p>
<dl class="section user"><dt>Description</dt><dd>This file wraps the ECC cryptographic functionality of the A71CH module. </dd></dl>
<dl class="section user"><dt>History</dt><dd>1.0 2016-Aug-26: Initial version 1.1 2017-Nov-30: Adding function A71_EccRestrictedSign 1.2 2018-Dec-12: Modified implementation of A71_EccSign to adapt reported size of ECDSA signature </dd></dl>

<p class="definition">Definition in file <a class="el" href="a71ch__crypto__ecc_8c_source.html">a71ch_crypto_ecc.c</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="abe1b6c3407c141921525f3396bc4e5ff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe1b6c3407c141921525f3396bc4e5ff">&#9670;&nbsp;</a></span>A71_EccNormalizedAsnSign()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">U16 A71_EccNormalizedAsnSign </td>
          <td>(</td>
          <td class="paramtype">SST_Index_t&#160;</td>
          <td class="paramname"><em>index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const U8 *&#160;</td>
          <td class="paramname"><em>pHash</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">U16&#160;</td>
          <td class="paramname"><em>hashLen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">U8 *&#160;</td>
          <td class="paramname"><em>pSignature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">U16 *&#160;</td>
          <td class="paramname"><em>pSignatureLen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Signs the hash <code>pHash</code> using the keypair at the indicated index.</p>
<p>The integer representation of the ECDSA signatures' r and s component is modified to be in line with ASN.1 (Ensuring an integer value is always encoded in the smallest possible number of octets) </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">index</td><td>Storage index of the keypair (private key) to be used. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pHash</td><td>Pointer to the provided hash (or any other bytestring). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hashLen</td><td>Length of the provided hash. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">pSignature</td><td>Pointer to the computed signature. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">pSignatureLen</td><td>Pointer to the length of the computed signature. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="sm__types_8h.html#a8c7b7be5dd3dcbaa85f9d9536fc93f55" title="Operation successfull. ">SW_OK</a></td><td>Upon successful execution </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="a71ch__crypto__ecc_8c_source.html#l00186">186</a> of file <a class="el" href="a71ch__crypto__ecc_8c_source.html">a71ch_crypto_ecc.c</a>.</p>

</div>
</div>
<a id="a6fa02cd309a1428d04680e3cef1e8bbd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6fa02cd309a1428d04680e3cef1e8bbd">&#9670;&nbsp;</a></span>A71_EccRestrictedSign()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">U16 A71_EccRestrictedSign </td>
          <td>(</td>
          <td class="paramtype">SST_Index_t&#160;</td>
          <td class="paramname"><em>index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const U8 *&#160;</td>
          <td class="paramname"><em>updateBytes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">U16&#160;</td>
          <td class="paramname"><em>updateBytesLen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">U8 *&#160;</td>
          <td class="paramname"><em>invocationCount</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Patches a predetermined fixed size memory region in GP storage with the byte array <code>updateBytes</code> Creates a signed certificate - in place in GP storage - using a predetermined block of GP storage data</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">index</td><td>Storage index of the keypair (private key) to be used. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">updateBytes</td><td>Byte array to be written into GP storage </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">updateBytesLen</td><td>Length of the provided byte array (<code>updateBytes</code>). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">invocationCount</td><td>Amount of times the underlying APDU has been called succesfully. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="sm__types_8h.html#a8c7b7be5dd3dcbaa85f9d9536fc93f55" title="Operation successfull. ">SW_OK</a></td><td>Upon successful execution </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="a71ch__crypto__ecc_8c_source.html#l00272">272</a> of file <a class="el" href="a71ch__crypto__ecc_8c_source.html">a71ch_crypto_ecc.c</a>.</p>

</div>
</div>
<a id="a92370ab35f373f9fe2707cfb512ab679"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a92370ab35f373f9fe2707cfb512ab679">&#9670;&nbsp;</a></span>A71_EccSign()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">U16 A71_EccSign </td>
          <td>(</td>
          <td class="paramtype">SST_Index_t&#160;</td>
          <td class="paramname"><em>index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const U8 *&#160;</td>
          <td class="paramname"><em>pHash</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">U16&#160;</td>
          <td class="paramname"><em>hashLen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">U8 *&#160;</td>
          <td class="paramname"><em>pSignature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">U16 *&#160;</td>
          <td class="paramname"><em>pSignatureLen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Signs the hash <code>pHash</code> using the keypair at the indicated index. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">index</td><td>Storage index of the keypair (private key) to be used. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pHash</td><td>Pointer to the provided hash (or any other bytestring). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hashLen</td><td>Length of the provided hash. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">pSignature</td><td>Pointer to the computed signature. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">pSignatureLen</td><td>Pointer to the length of the computed signature. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="sm__types_8h.html#a8c7b7be5dd3dcbaa85f9d9536fc93f55" title="Operation successfull. ">SW_OK</a></td><td>Upon successful execution </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="a71ch__crypto__ecc_8c_source.html#l00168">168</a> of file <a class="el" href="a71ch__crypto__ecc_8c_source.html">a71ch_crypto_ecc.c</a>.</p>

</div>
</div>
<a id="a487c69814972728b650acc9ac3c59d66"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a487c69814972728b650acc9ac3c59d66">&#9670;&nbsp;</a></span>A71_EccVerify()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">U16 A71_EccVerify </td>
          <td>(</td>
          <td class="paramtype">SST_Index_t&#160;</td>
          <td class="paramname"><em>index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const U8 *&#160;</td>
          <td class="paramname"><em>pHash</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">U16&#160;</td>
          <td class="paramname"><em>hashLen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const U8 *&#160;</td>
          <td class="paramname"><em>pSignature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">U16&#160;</td>
          <td class="paramname"><em>signatureLen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">U8 *&#160;</td>
          <td class="paramname"><em>pResult</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Verifies whether <code>pSignature</code> is the signature of <code>pHash</code> using the public key stored under <code>index</code> as the verifying public key.</p>
<p>The index refers to an instance of the PUBLIC_KEY secure storage class on the A71CH. </p><dl class="section note"><dt>Note</dt><dd>The public key of an ECC key pair cannot be used for a verify operation. </dd>
<dd>
<a class="el" href="a71ch__module_8c.html#ab4ea82d6235ac722b7e1dc835eae8551">A71_EccVerifyWithKey</a> allows to pass the value of the public key rather than use a stored public key.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">index</td><td>Storage index of the key used for the verification. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pHash</td><td>Pointer to the provided hash (or any other bytestring). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hashLen</td><td>Length of the provided hash (<code>pHash</code>). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pSignature</td><td>Pointer to the provided signature. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">signatureLen</td><td>Length of the provided signature (<code>pSignature</code>) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pResult</td><td>Pointer to the computed result of the verification. Points to a value of 0x01 in case of successful verification </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="sm__types_8h.html#a8c7b7be5dd3dcbaa85f9d9536fc93f55" title="Operation successfull. ">SW_OK</a></td><td>Upon successful execution </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="a71ch__crypto__ecc_8c_source.html#l00341">341</a> of file <a class="el" href="a71ch__crypto__ecc_8c_source.html">a71ch_crypto_ecc.c</a>.</p>

</div>
</div>
<a id="af8141ee41a54b0ac74ab48ae13a0571a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af8141ee41a54b0ac74ab48ae13a0571a">&#9670;&nbsp;</a></span>A71_EcdhGetSharedSecret()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">U16 A71_EcdhGetSharedSecret </td>
          <td>(</td>
          <td class="paramtype">U8&#160;</td>
          <td class="paramname"><em>index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const U8 *&#160;</td>
          <td class="paramname"><em>pOtherPublicKey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">U16&#160;</td>
          <td class="paramname"><em>otherPublicKeyLen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">U8 *&#160;</td>
          <td class="paramname"><em>pSharedSecret</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">U16 *&#160;</td>
          <td class="paramname"><em>pSharedSecretLen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Generates and retrieves a shared secret ECC point <code>pSharedSecret</code> using the private key stored at <code>index</code> and a public key <code>pOtherPublicKey</code> passed as argument. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">index</td><td>to the key pair (private key to be used) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pOtherPublicKey</td><td>Pointer to the given public key. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">otherPublicKeyLen</td><td>Length of the given public key. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">pSharedSecret</td><td>Pointer to the computed shared secret. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">pSharedSecretLen</td><td>Pointer to the length of the computed shared secret. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="sm__types_8h.html#a8c7b7be5dd3dcbaa85f9d9536fc93f55" title="Operation successfull. ">SW_OK</a></td><td>Upon successful execution </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="a71ch__crypto__ecc_8c_source.html#l00406">406</a> of file <a class="el" href="a71ch__crypto__ecc_8c_source.html">a71ch_crypto_ecc.c</a>.</p>

</div>
</div>
<a id="a8b9fc4efa629ccbd080260788b6e4ad2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8b9fc4efa629ccbd080260788b6e4ad2">&#9670;&nbsp;</a></span>A71_GenerateEccKeyPair()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">U16 A71_GenerateEccKeyPair </td>
          <td>(</td>
          <td class="paramtype">SST_Index_t&#160;</td>
          <td class="paramname"><em>index</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Generates an ECC keypair at storage location <code>index</code>. </p><dl class="section pre"><dt>Precondition</dt><dd>INJECTION_LOCKED has not been set </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">index</td><td>Storage index of the keypair to be created. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="sm__types_8h.html#a8c7b7be5dd3dcbaa85f9d9536fc93f55" title="Operation successfull. ">SW_OK</a></td><td>Upon successful execution </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="a71ch__crypto__ecc_8c_source.html#l00045">45</a> of file <a class="el" href="a71ch__crypto__ecc_8c_source.html">a71ch_crypto_ecc.c</a>.</p>

</div>
</div>
<a id="a8b6b20abac676f3524b0df14ccba9f8a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8b6b20abac676f3524b0df14ccba9f8a">&#9670;&nbsp;</a></span>A71_GenerateEccKeyPairWithChallenge()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">U16 A71_GenerateEccKeyPairWithChallenge </td>
          <td>(</td>
          <td class="paramtype">SST_Index_t&#160;</td>
          <td class="paramname"><em>index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const U8 *&#160;</td>
          <td class="paramname"><em>configKey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">U16&#160;</td>
          <td class="paramname"><em>configKeyLen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Generates an ECC keypair at storage location <code>index</code>. This function must be called instead of <a class="el" href="a71ch__crypto__ecc_8c.html#a8b9fc4efa629ccbd080260788b6e4ad2">A71_GenerateEccKeyPair</a> in case INJECTION_LOCKED was set.</p>
<p>To use this function the value of the Key Pair configuration key must be known on the host. If this is not the case use <a class="el" href="a71ch__crypto__ecc_8c.html#a0cef809f0f15c9c1416e64a55cfa784b">A71_GenerateEccKeyPairWithCode</a> instead.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">index</td><td>Storage index of the keypair to be created. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">configKey</td><td>Value of Key Pair configuration key. This value has a high level of confidentiality and may not be available to the Host. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">configKeyLen</td><td>Length of Key Pair configuration key </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="sm__types_8h.html#a8c7b7be5dd3dcbaa85f9d9536fc93f55" title="Operation successfull. ">SW_OK</a></td><td>Upon successful execution </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="a71ch__crypto__ecc_8c_source.html#l00083">83</a> of file <a class="el" href="a71ch__crypto__ecc_8c_source.html">a71ch_crypto_ecc.c</a>.</p>

</div>
</div>
<a id="a0cef809f0f15c9c1416e64a55cfa784b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0cef809f0f15c9c1416e64a55cfa784b">&#9670;&nbsp;</a></span>A71_GenerateEccKeyPairWithCode()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">U16 A71_GenerateEccKeyPairWithCode </td>
          <td>(</td>
          <td class="paramtype">SST_Index_t&#160;</td>
          <td class="paramname"><em>index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const U8 *&#160;</td>
          <td class="paramname"><em>code</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">U16&#160;</td>
          <td class="paramname"><em>codeLen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Generates an ECC keypair at storage location <code>index</code>. This function must be called instead of <a class="el" href="a71ch__crypto__ecc_8c.html#a8b9fc4efa629ccbd080260788b6e4ad2">A71_GenerateEccKeyPair</a> in case INJECTION_LOCKED was set.</p>
<p>The assumption is the value of the Key Pair configuration key is not known on the host. If this does not apply use <a class="el" href="a71ch__crypto__ecc_8c.html#a8b6b20abac676f3524b0df14ccba9f8a">A71_GenerateEccKeyPairWithChallenge</a> instead.</p>
<p>The code is calculated as follows:</p><ul>
<li>Request a challenge from A71CH using <a class="el" href="a71ch__module_8c.html#a1504b46b3aa3c29b9b67cd33e566ccdc">A71_GetUnlockChallenge</a>.</li>
<li>Decrypt the challenge in ECB mode using the appropriate configuration key value (the same as stored at index <a class="el" href="a71ch__api_8h.html#a944e4723836f8de847ade4291ba357ab" title="Index to configuration key storage (private key wrapping key) ">A71CH_CFG_KEY_IDX_PRIVATE_KEYS</a>).</li>
<li>The decrypted value is the value of <code>code</code> </li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">index</td><td>Storage index of the keypair to be created. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">code</td><td>Value of unlock code. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">codeLen</td><td>Length of unlock code (must be 16) </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="sm__types_8h.html#a8c7b7be5dd3dcbaa85f9d9536fc93f55" title="Operation successfull. ">SW_OK</a></td><td>Upon successful execution </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="a71ch__crypto__ecc_8c_source.html#l00127">127</a> of file <a class="el" href="a71ch__crypto__ecc_8c_source.html">a71ch_crypto_ecc.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_334bf0e2cc3331174eefb01118a0a83d.html">hostLib</a></li><li class="navelem"><a class="el" href="dir_ceffb261bb5d756d1931d3d27f14ec57.html">a71ch</a></li><li class="navelem"><a class="el" href="dir_aea1d74edf7334533e1d37ace23cdbae.html">src</a></li><li class="navelem"><a class="el" href="a71ch__crypto__ecc_8c.html">a71ch_crypto_ecc.c</a></li>
    <li class="footer">Generated on Fri Sep 7 2018 19:24:07 for A71CH Host Sw by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
